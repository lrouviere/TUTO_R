<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 7 Estimation et intervalles de confiance | Introduction à R et à la modélisation statistique</title>
  <meta name="description" content="Chapitre 7 Estimation et intervalles de confiance | Introduction à R et à la modélisation statistique" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 7 Estimation et intervalles de confiance | Introduction à R et à la modélisation statistique" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 7 Estimation et intervalles de confiance | Introduction à R et à la modélisation statistique" />
  
  
  

<meta name="author" content="Laurent Rouvière" />


<meta name="date" content="2022-03-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="faire-de-la-régression-sur-r.html"/>
<link rel="next" href="références.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/amcharts-3.21.13/amcharts.js"></script>
<script src="libs/ramcharts_base-binding-2.1.13/ramcharts_base.js"></script>
<script src="libs/amcharts_type_serial-3.20.18/serial.js"></script>
<script src="libs/amcharts_themes_light.js-3.20.18/light.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.0/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.0/leaflet-providers-plugin.js"></script>
<link href="libs/vis-9.1.0/vis-network.min.css" rel="stylesheet" />
<script src="libs/vis-9.1.0/vis-network.min.js"></script>
<script src="libs/visNetwork-binding-2.1.0/visNetwork.js"></script>
<script src="libs/FileSaver-1.1.20151003/FileSaver.min.js"></script>
<script src="libs/Blob-1.0/Blob.js"></script>
<script src="libs/canvas-toBlob-1.0/canvas-toBlob.js"></script>
<script src="libs/html2canvas-0.5.0/html2canvas.js"></script>
<script src="libs/jspdf-1.3.2/jspdf.debug.js"></script>
<link href="libs/jquery-sparkline-2.1.2/jquery.sparkline.css" rel="stylesheet" />
<script src="libs/jquery-sparkline-2.1.2/jquery.sparkline.js"></script>
<script src="libs/sparkline-binding-2.0/sparkline.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction à R<br> <br> L. Rouvière</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Présentation</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#r-script"><i class="fa fa-check"></i><b>1.1</b> R Script</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#packages"><i class="fa fa-check"></i><b>1.2</b> Packages</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#markdown"><i class="fa fa-check"></i><b>1.3</b> Markdown</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="intro.html"><a href="intro.html#syntaxe"><i class="fa fa-check"></i><b>1.3.1</b> Syntaxe</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro.html"><a href="intro.html#les-chunks"><i class="fa fa-check"></i><b>1.3.2</b> Les chunks</a></li>
<li class="chapter" data-level="1.3.3" data-path="intro.html"><a href="intro.html#notebook"><i class="fa fa-check"></i><b>1.3.3</b> Notebook</a></li>
<li class="chapter" data-level="1.3.4" data-path="intro.html"><a href="intro.html#diaporama-r"><i class="fa fa-check"></i><b>1.3.4</b> Diaporama R</a></li>
<li class="chapter" data-level="1.3.5" data-path="intro.html"><a href="intro.html#exemples-de-styles-de-documents-markdown"><i class="fa fa-check"></i><b>1.3.5</b> Exemples de styles de documents markdown</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="objetsR.html"><a href="objetsR.html"><i class="fa fa-check"></i><b>2</b> Les objets R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="objetsR.html"><a href="objetsR.html#création-dobjets"><i class="fa fa-check"></i><b>2.1</b> Création d’objets</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="objetsR.html"><a href="objetsR.html#numérique"><i class="fa fa-check"></i><b>2.1.1</b> Numérique</a></li>
<li class="chapter" data-level="2.1.2" data-path="objetsR.html"><a href="objetsR.html#caractère"><i class="fa fa-check"></i><b>2.1.2</b> Caractère</a></li>
<li class="chapter" data-level="2.1.3" data-path="objetsR.html"><a href="objetsR.html#facteur"><i class="fa fa-check"></i><b>2.1.3</b> Facteur</a></li>
<li class="chapter" data-level="2.1.4" data-path="objetsR.html"><a href="objetsR.html#logique-booléen"><i class="fa fa-check"></i><b>2.1.4</b> Logique (Booléen)</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="objetsR.html"><a href="objetsR.html#vecteur"><i class="fa fa-check"></i><b>2.2</b> Vecteur</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="objetsR.html"><a href="objetsR.html#sélectionner-une-partie-dun-vecteur"><i class="fa fa-check"></i><b>2.2.1</b> Sélectionner une partie d’un vecteur</a></li>
<li class="chapter" data-level="2.2.2" data-path="objetsR.html"><a href="objetsR.html#opérations-sur-les-vecteurs"><i class="fa fa-check"></i><b>2.2.2</b> Opérations sur les vecteurs</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="objetsR.html"><a href="objetsR.html#matrices"><i class="fa fa-check"></i><b>2.3</b> Matrices</a></li>
<li class="chapter" data-level="2.4" data-path="objetsR.html"><a href="objetsR.html#listes"><i class="fa fa-check"></i><b>2.4</b> Listes</a></li>
<li class="chapter" data-level="2.5" data-path="objetsR.html"><a href="objetsR.html#dataframe"><i class="fa fa-check"></i><b>2.5</b> Dataframe</a></li>
<li class="chapter" data-level="2.6" data-path="objetsR.html"><a href="objetsR.html#quelques-fonctions-importantes"><i class="fa fa-check"></i><b>2.6</b> Quelques fonctions importantes</a></li>
<li class="chapter" data-level="2.7" data-path="objetsR.html"><a href="objetsR.html#exercices-complémentaires"><i class="fa fa-check"></i><b>2.7</b> Exercices complémentaires</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>3</b> Manipuler les données avec dplyr</a>
<ul>
<li class="chapter" data-level="3.1" data-path="dplyr.html"><a href="dplyr.html#importer-des-données"><i class="fa fa-check"></i><b>3.1</b> Importer des données</a></li>
<li class="chapter" data-level="3.2" data-path="dplyr.html"><a href="dplyr.html#le-package-dplyr"><i class="fa fa-check"></i><b>3.2</b> Le package dplyr</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="dplyr.html"><a href="dplyr.html#les-principaux-verbres-dplyr"><i class="fa fa-check"></i><b>3.2.1</b> Les principaux verbres dplyr</a></li>
<li class="chapter" data-level="3.2.2" data-path="dplyr.html"><a href="dplyr.html#les-verbes-summarize-et-groub_by"><i class="fa fa-check"></i><b>3.2.2</b> Les verbes <code>summarize</code> et <code>groub_by</code></a></li>
<li class="chapter" data-level="3.2.3" data-path="dplyr.html"><a href="dplyr.html#assembler-des-verbes-avec-lopérateur-de-chainage"><i class="fa fa-check"></i><b>3.2.3</b> Assembler des verbes avec l’opérateur de chainage <code>%&gt;%</code></a></li>
<li class="chapter" data-level="3.2.4" data-path="dplyr.html"><a href="dplyr.html#quelques-exercices"><i class="fa fa-check"></i><b>3.2.4</b> Quelques exercices</a></li>
<li class="chapter" data-level="3.2.5" data-path="dplyr.html"><a href="dplyr.html#compléments-tidy-data-avec-tidyr"><i class="fa fa-check"></i><b>3.2.5</b> Compléments : Tidy data avec tidyr</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>4</b> Visualisation avec ggplot2</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ggplot2.html"><a href="ggplot2.html#fonctions-graphiques-conventionnelles"><i class="fa fa-check"></i><b>4.1</b> Fonctions graphiques conventionnelles</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="ggplot2.html"><a href="ggplot2.html#la-fonction-plot"><i class="fa fa-check"></i><b>4.1.1</b> La fonction <strong>plot</strong></a></li>
<li class="chapter" data-level="4.1.2" data-path="ggplot2.html"><a href="ggplot2.html#graphes-interactifs-avec-ramcharts"><i class="fa fa-check"></i><b>4.1.2</b> Graphes interactifs avec rAmCharts</a></li>
<li class="chapter" data-level="4.1.3" data-path="ggplot2.html"><a href="ggplot2.html#quelques-exercices-1"><i class="fa fa-check"></i><b>4.1.3</b> Quelques exercices</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="ggplot2.html"><a href="ggplot2.html#la-grammaire-ggplot2"><i class="fa fa-check"></i><b>4.2</b> La grammaire <strong>ggplot2</strong></a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="ggplot2.html"><a href="ggplot2.html#premiers-graphes-ggplot2"><i class="fa fa-check"></i><b>4.2.1</b> Premiers graphes <code>ggplot2</code></a></li>
<li class="chapter" data-level="4.2.2" data-path="ggplot2.html"><a href="ggplot2.html#data-et-aesthetics"><i class="fa fa-check"></i><b>4.2.2</b> Data et aesthetics</a></li>
<li class="chapter" data-level="4.2.3" data-path="ggplot2.html"><a href="ggplot2.html#geometrics"><i class="fa fa-check"></i><b>4.2.3</b> Geometrics</a></li>
<li class="chapter" data-level="4.2.4" data-path="ggplot2.html"><a href="ggplot2.html#statistics"><i class="fa fa-check"></i><b>4.2.4</b> Statistics</a></li>
<li class="chapter" data-level="4.2.5" data-path="ggplot2.html"><a href="ggplot2.html#scales"><i class="fa fa-check"></i><b>4.2.5</b> Scales</a></li>
<li class="chapter" data-level="4.2.6" data-path="ggplot2.html"><a href="ggplot2.html#group-et-facets"><i class="fa fa-check"></i><b>4.2.6</b> Group et facets</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="ggplot2.html"><a href="ggplot2.html#compléments"><i class="fa fa-check"></i><b>4.3</b> Compléments</a></li>
<li class="chapter" data-level="4.4" data-path="ggplot2.html"><a href="ggplot2.html#quelques-exercices-supplémentaires"><i class="fa fa-check"></i><b>4.4</b> Quelques exercices supplémentaires</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="leaflet.html"><a href="leaflet.html"><i class="fa fa-check"></i><b>5</b> Faire des cartes interactives avec leaflet</a>
<ul>
<li class="chapter" data-level="5.1" data-path="leaflet.html"><a href="leaflet.html#présentation-de-leaflet"><i class="fa fa-check"></i><b>5.1</b> Présentation de leaflet</a></li>
<li class="chapter" data-level="5.2" data-path="leaflet.html"><a href="leaflet.html#challenge-visualisation-des-stations-velib-à-paris"><i class="fa fa-check"></i><b>5.2</b> Challenge : Visualisation des stations velib à Paris</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="faire-de-la-régression-sur-r.html"><a href="faire-de-la-régression-sur-r.html"><i class="fa fa-check"></i><b>6</b> Faire de la régression sur R</a>
<ul>
<li class="chapter" data-level="6.1" data-path="faire-de-la-régression-sur-r.html"><a href="faire-de-la-régression-sur-r.html#modèle-linéaire-fonctions-lm-et-predict"><i class="fa fa-check"></i><b>6.1</b> Modèle linéaire : fonctions lm et predict</a></li>
<li class="chapter" data-level="6.2" data-path="faire-de-la-régression-sur-r.html"><a href="faire-de-la-régression-sur-r.html#sélection-de-variables"><i class="fa fa-check"></i><b>6.2</b> Sélection de variables</a></li>
<li class="chapter" data-level="6.3" data-path="faire-de-la-régression-sur-r.html"><a href="faire-de-la-régression-sur-r.html#régression-logistique-et-arbre"><i class="fa fa-check"></i><b>6.3</b> Régression logistique et arbre</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="estimation.html"><a href="estimation.html"><i class="fa fa-check"></i><b>7</b> Estimation et intervalles de confiance</a>
<ul>
<li class="chapter" data-level="7.1" data-path="estimation.html"><a href="estimation.html#générer-des-observations-selon-des-lois-de-probabilités"><i class="fa fa-check"></i><b>7.1</b> Générer des observations selon des lois de probabilités</a></li>
<li class="chapter" data-level="7.2" data-path="estimation.html"><a href="estimation.html#une-étude-numérique-de-la-moyenne-empirique."><i class="fa fa-check"></i><b>7.2</b> Une étude numérique de la moyenne empirique.</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="estimation.html"><a href="estimation.html#exemple"><i class="fa fa-check"></i><b>7.2.1</b> Exemple</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="estimation.html"><a href="estimation.html#intervalles-de-confiance"><i class="fa fa-check"></i><b>7.3</b> Intervalles de confiance</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="références.html"><a href="références.html"><i class="fa fa-check"></i>Références</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction à R et à la modélisation statistique</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="estimation" class="section level1" number="7">
<h1><span class="header-section-number">Chapitre 7</span> Estimation et intervalles de confiance</h1>
<p>Dans cette partie nous allons construire des échantillons par simulation et nous intéresser à l’étude de la moyenne de ces échantillons.</p>
<div id="générer-des-observations-selon-des-lois-de-probabilités" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Générer des observations selon des lois de probabilités</h2>
<p><strong>R</strong> étant un logiciel de statistique, il est bien entendu possible de</p>
<ul>
<li>visualiser</li>
<li>calculer des quantiles</li>
<li>générer des observations</li>
</ul>
<p>pour toutes les lois classiques de probabilités. Chaque loi va être identifiée par une chaîne de caractères :</p>
<table>
<thead>
<tr class="header">
<th align="center">Loi</th>
<th align="center">Chaine</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Binomiale</td>
<td align="center">binom</td>
</tr>
<tr class="even">
<td align="center">Poisson</td>
<td align="center">pois</td>
</tr>
<tr class="odd">
<td align="center">Uniforme</td>
<td align="center">unif</td>
</tr>
<tr class="even">
<td align="center">Exponentielle</td>
<td align="center">exp</td>
</tr>
<tr class="odd">
<td align="center">Normale</td>
<td align="center">norm</td>
</tr>
</tbody>
</table>
<p>Un préfixe permettra de spécifier l’action que l’on souhaite effectuer sur la loi :</p>
<ul>
<li><strong>d</strong> : calculer la densité pour une loi continue ou la fonction de masse pour une loi discrète</li>
<li><strong>q</strong> : calculer les quantiles</li>
<li><strong>r</strong> : générer des observations.</li>
</ul>
<p>On pourra par exemple :</p>
<ul>
<li><p>Calculer la densité de la loi <span class="math inline">\(\mathcal N(0,1)\)</span> en -1,0,1 avec</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="estimation.html#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dnorm</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb284-2"><a href="estimation.html#cb284-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.2419707</span> <span class="fl">0.3989423</span> <span class="fl">0.2419707</span></span></code></pre></div></li>
<li><p>Calculer les quantiles d’ordre 0.05, 0.5 et 0.95 de la loi <span class="math inline">\(\mathcal N(0,1)\)</span> en -1,0,1 avec</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="estimation.html#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">0.5</span>,<span class="fl">0.95</span>),<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb285-2"><a href="estimation.html#cb285-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="sc">-</span><span class="fl">1.644854</span>  <span class="fl">0.000000</span>  <span class="fl">1.644854</span></span></code></pre></div></li>
<li><p>Générer 10 observations selon une loi <span class="math inline">\(\mathcal N(0,1)\)</span> avec</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="estimation.html#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb286-2"><a href="estimation.html#cb286-2" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="sc">-</span><span class="fl">0.45804243</span> <span class="sc">-</span><span class="fl">0.54660530</span>  <span class="fl">0.09368364</span>  <span class="fl">1.26277359</span></span>
<span id="cb286-3"><a href="estimation.html#cb286-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">5</span>]  <span class="fl">0.26740505</span> <span class="sc">-</span><span class="fl">1.10087461</span> <span class="sc">-</span><span class="fl">0.43779738</span> <span class="sc">-</span><span class="fl">0.51948187</span></span>
<span id="cb286-4"><a href="estimation.html#cb286-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">9</span>] <span class="sc">-</span><span class="fl">1.17653262</span> <span class="sc">-</span><span class="fl">0.36622337</span></span></code></pre></div></li>
</ul>
<div class="exercise">
<p><span id="exr:exo-loibinomiale" class="exercise"><strong>Exercice 7.1  (Loi binomiale) </strong></span>On étudie les fonctions <code>R</code> associées à la loi binomiale.</p>
<ol style="list-style-type: decimal">
<li><p>Soit <span class="math inline">\(X\)</span> un variable de loi binomiale <span class="math inline">\(B(20,0.6)\)</span>. Calculer la probabilité que <span class="math inline">\(X\)</span> soit égale à 1,5,10,15.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="estimation.html#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">15</span>),<span class="at">size=</span><span class="dv">20</span>,<span class="at">prob=</span><span class="fl">0.6</span>)</span>
<span id="cb287-2"><a href="estimation.html#cb287-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">3.298535e-07</span> <span class="fl">1.294494e-03</span> <span class="fl">1.171416e-01</span> <span class="fl">7.464702e-02</span></span></code></pre></div></li>
<li><p>Pour la même loi calculer la probabilités :
<span class="math display">\[\mathbf P(X\leq 13),\quad\mathbf P(X&gt;13),\quad \mathbf P(X\geq 13)\quad\text{et}\quad \mathbf P(X\in[8,15]).\]</span></p>
<div class="corR">
<p>
Pour la première il suffit d’utiliser <strong>pbinorm</strong> :
</p>
</div>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="estimation.html#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">13</span>,<span class="at">size=</span><span class="dv">20</span>,<span class="at">prob=</span><span class="fl">0.6</span>)</span>
<span id="cb288-2"><a href="estimation.html#cb288-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.7499893</span></span></code></pre></div>
<div class="corR">
<p>
On remarque ensuite que <span class="math display"><span class="math display">\[\mathbf P(X&gt;13)=1-\mathbf P(X\leq 13)\quad\text{et}\quad\mathbf P(X\geq 13)=\mathbf P(X&gt;13)+\mathbf P(X=13)\]</span></span>
</p>
<p>
donc
</p>
</div>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="estimation.html#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pbinom</span>(<span class="dv">13</span>,<span class="at">size=</span><span class="dv">20</span>,<span class="at">prob=</span><span class="fl">0.6</span>)</span>
<span id="cb289-2"><a href="estimation.html#cb289-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.2500107</span></span>
<span id="cb289-3"><a href="estimation.html#cb289-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pbinom</span>(<span class="dv">13</span>,<span class="at">size=</span><span class="dv">20</span>,<span class="at">prob=</span><span class="fl">0.6</span>)<span class="sc">+</span><span class="fu">dbinom</span>(<span class="dv">13</span>,<span class="at">size=</span><span class="dv">20</span>,<span class="at">prob=</span><span class="fl">0.6</span>)</span>
<span id="cb289-4"><a href="estimation.html#cb289-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.4158929</span></span></code></pre></div>
<div class="corR">
<p>
Pour la dernière, on utilise <span class="math display"><span class="math display">\[\mathbf P(X\in[8,15]=\mathbf P(X\leq 15)-\mathbf P(X\leq 8)+\mathbf P(X=8)\]</span></span>
</p>
</div>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="estimation.html#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">15</span>,<span class="at">size=</span><span class="dv">20</span>,<span class="at">prob=</span><span class="fl">0.6</span>)<span class="sc">-</span><span class="fu">pbinom</span>(<span class="dv">8</span>,<span class="at">size=</span><span class="dv">20</span>,<span class="at">prob=</span><span class="fl">0.6</span>)<span class="sc">+</span><span class="fu">dbinom</span>(<span class="dv">8</span>,<span class="at">size=</span><span class="dv">20</span>,<span class="at">prob=</span><span class="fl">0.6</span>)</span>
<span id="cb290-2"><a href="estimation.html#cb290-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.9280191</span></span></code></pre></div>
<div class="corR">
<p>
On aurait aussi pu faire
</p>
</div>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="estimation.html#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">dbinom</span>(<span class="dv">8</span><span class="sc">:</span><span class="dv">15</span>,<span class="at">size=</span><span class="dv">20</span>,<span class="at">prob=</span><span class="fl">0.6</span>))</span>
<span id="cb291-2"><a href="estimation.html#cb291-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.9280191</span></span></code></pre></div></li>
<li><p>Représenter le diagramme en barre associé à la loi <span class="math inline">\(B(20,0.6)\)</span>. On pourra utiliser l’argument <strong>stat=“identity”</strong> dans la fonction <strong>geom_bar</strong>.</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="estimation.html#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb292-2"><a href="estimation.html#cb292-2" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>,<span class="at">size=</span><span class="dv">20</span>,<span class="at">prob=</span><span class="fl">0.6</span>)</span>
<span id="cb292-3"><a href="estimation.html#cb292-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>,<span class="at">prob=</span>prob)</span>
<span id="cb292-4"><a href="estimation.html#cb292-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>prob)<span class="sc">+</span><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">width=</span><span class="fl">0.15</span>)<span class="sc">+</span><span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-205-1.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p>Générer un échantillon de taille 5000 selon la loi <span class="math inline">\(B(20,0.6)\)</span>. Tracer le diagramme en barres associé à cet échantillon et comparer le à celui de la question précédente.</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="estimation.html#cb293-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">5000</span>,<span class="at">size=</span><span class="dv">20</span>,<span class="at">prob=</span><span class="fl">0.6</span>)</span>
<span id="cb293-2"><a href="estimation.html#cb293-2" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X=</span>X)</span>
<span id="cb293-3"><a href="estimation.html#cb293-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df1)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>X,<span class="at">y=</span>..prop..)<span class="sc">+</span><span class="fu">geom_bar</span>(<span class="at">width=</span><span class="fl">0.15</span>)<span class="sc">+</span><span class="fu">theme_classic</span>()<span class="sc">+</span><span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20</span>))</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-206-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="corR">
<p>
On peut visualiser les digrammes en barres cote à cote avec
</p>
</div>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="estimation.html#cb294-1" aria-hidden="true" tabindex="-1"></a>prop <span class="ot">&lt;-</span> <span class="fu">table</span>(X)<span class="sc">/</span><span class="dv">5000</span></span>
<span id="cb294-2"><a href="estimation.html#cb294-2" aria-hidden="true" tabindex="-1"></a>prop1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X=</span><span class="fu">as.numeric</span>(<span class="fu">names</span>(prop)),<span class="at">Freq=</span><span class="fu">as.numeric</span>(prop))</span>
<span id="cb294-3"><a href="estimation.html#cb294-3" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">full_join</span>(df,prop1,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;x&quot;</span><span class="ot">=</span><span class="st">&quot;X&quot;</span>))</span>
<span id="cb294-4"><a href="estimation.html#cb294-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df2)[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Theo&quot;</span>,<span class="st">&quot;Emp&quot;</span>)</span>
<span id="cb294-5"><a href="estimation.html#cb294-5" aria-hidden="true" tabindex="-1"></a>df2[<span class="fu">is.na</span>(df2)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb294-6"><a href="estimation.html#cb294-6" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> df2 <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="sc">-</span>x,<span class="at">names_to=</span><span class="st">&quot;type&quot;</span>,<span class="at">values_to=</span><span class="st">&quot;valeur&quot;</span>)</span>
<span id="cb294-7"><a href="estimation.html#cb294-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df3)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>valeur,<span class="at">fill=</span>type)<span class="sc">+</span><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">position=</span><span class="st">&#39;dodge&#39;</span>,<span class="at">width=</span><span class="fl">0.25</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-208-1.png" width="672" style="display: block; margin: auto;" /></p></li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:exo-loinormale" class="exercise"><strong>Exercice 7.2  (Loi normale) </strong></span>On considère ici la loi normale <span class="math inline">\(\mathcal N(\mu,\sigma^2)\)</span>.</p>
<ol style="list-style-type: decimal">
<li><p>Tracer la densité de la loi <span class="math inline">\(\mathcal N(0,1)\)</span>.</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="estimation.html#cb295-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>,<span class="at">by=</span><span class="fl">0.01</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y=</span><span class="fu">dnorm</span>(x))</span>
<span id="cb295-2"><a href="estimation.html#cb295-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y)<span class="sc">+</span><span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-209-1.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p>Soit <span class="math inline">\(X\)</span> une variable aléatoire de loi <span class="math inline">\(\mathcal N(2,2^2)\)</span> (variance 4, écart-type 2). Calculer les probabilités suivantes :
<span class="math display">\[\mathbf P(X=2),\quad \mathbf P(X\leq 2),\quad \mathbf P(X&lt;2),\quad \mathbf P(X&gt;3).\]</span></p>
<div class="corR">
<p>
La première probabilité est nulle. Les deux suivantes sont égales et valent
</p>
</div>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="estimation.html#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb296-2"><a href="estimation.html#cb296-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.5</span></span></code></pre></div>
<div class="corR">
<p>
On obtient la dernière avec
</p>
</div>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="estimation.html#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb297-2"><a href="estimation.html#cb297-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3085375</span></span></code></pre></div></li>
<li><p>Générer un échantillon de taille 5000 selon la loi <span class="math inline">\(\mathcal N(0,1)\)</span>. Tracer l’histogramme associé à cet échantillon et comparer le à la densité tracée à la question précédente (on pourra supperposer les 2 représentations).</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="estimation.html#cb298-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X=</span><span class="fu">rnorm</span>(<span class="dv">5000</span>))</span>
<span id="cb298-2"><a href="estimation.html#cb298-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df1)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>X,<span class="at">y=</span>..density..)<span class="sc">+</span><span class="fu">geom_histogram</span>()<span class="sc">+</span><span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb298-3"><a href="estimation.html#cb298-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>df,<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y),<span class="at">color=</span><span class="st">&quot;red&quot;</span>,<span class="at">size=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-214-1.png" width="672" style="display: block; margin: auto;" /></p></li>
</ol>
</div>
</div>
<div id="une-étude-numérique-de-la-moyenne-empirique." class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Une étude numérique de la moyenne empirique.</h2>
<p>On considère un échantillon de <span class="math inline">\(x_1,\dots,x_n\)</span> i.i.d de loi uniforme sur <span class="math inline">\([a,b]\)</span> avec <span class="math inline">\(a\)</span> et <span class="math inline">\(b\)</span> supposés inconnus. Le problème est d’estimer l’espérance de cette loi uniforme
<span class="math display">\[\mathbf E[X]=\frac{a+b}{2}.\]</span></p>
<p>Un estimateur naturel est la moyenne empirique
<span class="math display">\[\bar x_n=\frac{1}{n}\sum_{i=1}^nx_i\]</span>
Remarquons déjà que la moyenne empirique dépend des observations <span class="math inline">\(x_1,\dots,x_n\)</span> : la moyenne va donc changer lorsque les observations changent.</p>
<div id="exemple" class="section level3" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Exemple</h3>
<p>Pour fixer les idées, on suppose dans cette partie que <span class="math inline">\(a=0\)</span> et <span class="math inline">\(b=1\)</span>. L’espréance à estier est donc 0.5 (on peut faire comme si on le la connaissait pas.)</p>
<p>On considère deux échantillons de taille 20 générées selon une loi uniforme entre 0 et 1 :</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="estimation.html#cb299-1" aria-hidden="true" tabindex="-1"></a>ech1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">20</span>)</span>
<span id="cb299-2"><a href="estimation.html#cb299-2" aria-hidden="true" tabindex="-1"></a>ech2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">20</span>)</span>
<span id="cb299-3"><a href="estimation.html#cb299-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(ech1,ech2)</span></code></pre></div>
<p>Les moyennes empiriques pour ces deux échantillons sont différentes :</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="estimation.html#cb300-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">summarise_all</span>(mean)</span>
<span id="cb300-2"><a href="estimation.html#cb300-2" aria-hidden="true" tabindex="-1"></a>       ech1      ech2</span>
<span id="cb300-3"><a href="estimation.html#cb300-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="fl">0.4296469</span> <span class="fl">0.4480178</span></span></code></pre></div>
<p>La moyenne empirique peut-être considérée comme une <strong>variable aléatoire</strong> : elle va donc posséder une loi de probabilité, une espérance… Si on considère l’exemple précédent, on sent bien que la distribution de la moyenne empirique doit</p>
<ul>
<li>se répartir autours de 0.5 (qui est la valeur à estimer).</li>
<li>être de plus en plus concentrée autours de 0.5 lorsque le nombre d’observations <span class="math inline">\(n\)</span> augmente.</li>
</ul>
<p>On peut visualiser ce fait en considérant un grand nombre d’échantillon et en regardant comment se comporte les valeurs moyennes de chaque échantillon. Pour cela on</p>
<ol style="list-style-type: decimal">
<li><p>génère un nombre <span class="math inline">\(B\)</span> (grand) d’échantillons de taille <span class="math inline">\(n=20\)</span> selon une loi uniforme entre 0 et 1.</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="estimation.html#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb301-2"><a href="estimation.html#cb301-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(<span class="dv">20</span><span class="sc">*</span><span class="dv">5000</span>),<span class="at">nrow=</span><span class="dv">20</span>) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>()</span></code></pre></div></li>
<li><p>calcule les moyennes obtenues pour chaque échantillon</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="estimation.html#cb302-1" aria-hidden="true" tabindex="-1"></a>moy <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">summarize_all</span>(mean)</span>
<span id="cb302-2"><a href="estimation.html#cb302-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">t</span>(moy))</span>
<span id="cb302-3"><a href="estimation.html#cb302-3" aria-hidden="true" tabindex="-1"></a>        [,<span class="dv">1</span>]</span>
<span id="cb302-4"><a href="estimation.html#cb302-4" aria-hidden="true" tabindex="-1"></a>V1 <span class="fl">0.4719301</span></span>
<span id="cb302-5"><a href="estimation.html#cb302-5" aria-hidden="true" tabindex="-1"></a>V2 <span class="fl">0.4449401</span></span>
<span id="cb302-6"><a href="estimation.html#cb302-6" aria-hidden="true" tabindex="-1"></a>V3 <span class="fl">0.4833523</span></span>
<span id="cb302-7"><a href="estimation.html#cb302-7" aria-hidden="true" tabindex="-1"></a>V4 <span class="fl">0.3740339</span></span>
<span id="cb302-8"><a href="estimation.html#cb302-8" aria-hidden="true" tabindex="-1"></a>V5 <span class="fl">0.4132300</span></span>
<span id="cb302-9"><a href="estimation.html#cb302-9" aria-hidden="true" tabindex="-1"></a>V6 <span class="fl">0.3734092</span></span></code></pre></div></li>
<li><p>visualise la distribution de la moyenne de chaque échantillon (en traçant l’histogramme de ces valeurs par exemple).</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="estimation.html#cb303-1" aria-hidden="true" tabindex="-1"></a>moy <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">M=</span><span class="fu">t</span>(moy))</span>
<span id="cb303-2"><a href="estimation.html#cb303-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(moy)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>M,<span class="at">y=</span>..density..)<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>)<span class="sc">+</span><span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-219-1.png" width="672" style="display: block; margin: auto;" /></p></li>
</ol>
<p>On voit que cette distribution semble se comporter comme une <strong>distribution gaussienne</strong> autours de la vraie valeur (0.5). Le théorème central limite confirme (et surtout prouve) ce constat. En effet, le théorème central limite nous dit que cette moyenne <span class="math inline">\(\bar x_n\)</span> vérifie
<span class="math display">\[\sqrt{n}\frac{\bar x_n-\mu}{\sigma}\to \mathcal N(0,1)\]</span>
avec <span class="math inline">\(\mu=0.5\)</span> et <span class="math inline">\(\sigma=1/\sqrt{12}\)</span> ici. On a donc
<span class="math display">\[\sqrt{n}\frac{\bar X_n-0.5}{1/\sqrt{12}}\to \mathcal N(0,1)\]</span>
Ce qui signifie qu’on peut approcher la loi de <span class="math inline">\(\bar X_n\)</span> par la loi <span class="math inline">\(\mathcal N(0.5,1/(12n))\)</span> avec <span class="math inline">\(n=20\)</span>. On le retrouve sur notre exemple en supperposant cette distribution gaussienne sur l’histogramme</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="estimation.html#cb304-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.25</span>,<span class="fl">0.75</span>,<span class="at">by=</span><span class="fl">0.001</span>)</span>
<span id="cb304-2"><a href="estimation.html#cb304-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x,<span class="at">y=</span><span class="fu">dnorm</span>(x,<span class="fl">0.5</span>,<span class="dv">1</span><span class="sc">/</span>(<span class="fu">sqrt</span>(<span class="dv">12</span><span class="sc">*</span><span class="dv">20</span>))))</span>
<span id="cb304-3"><a href="estimation.html#cb304-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(moy)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>M,<span class="at">y=</span>..density..)<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>)<span class="sc">+</span></span>
<span id="cb304-4"><a href="estimation.html#cb304-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>df,<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y),<span class="at">color=</span><span class="st">&quot;red&quot;</span>,<span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-220-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="exercise">
<p><span id="exr:exo-TCL" class="exercise"><strong>Exercice 7.3  (Théorème central limite) </strong></span>Faire le même travail pour des tailles d’échantillon de 50, 100 et 500. Interpréter.</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="estimation.html#cb305-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(<span class="dv">20</span><span class="sc">*</span><span class="dv">5000</span>),<span class="at">nrow=</span><span class="dv">20</span>) </span>
<span id="cb305-2"><a href="estimation.html#cb305-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(<span class="dv">50</span><span class="sc">*</span><span class="dv">5000</span>),<span class="at">nrow=</span><span class="dv">50</span>) </span>
<span id="cb305-3"><a href="estimation.html#cb305-3" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(<span class="dv">100</span><span class="sc">*</span><span class="dv">5000</span>),<span class="at">nrow=</span><span class="dv">100</span>) </span>
<span id="cb305-4"><a href="estimation.html#cb305-4" aria-hidden="true" tabindex="-1"></a>df4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(<span class="dv">500</span><span class="sc">*</span><span class="dv">5000</span>),<span class="at">nrow=</span><span class="dv">500</span>)</span>
<span id="cb305-5"><a href="estimation.html#cb305-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n20=</span><span class="fu">apply</span>(df1,<span class="dv">2</span>,mean),<span class="at">n50=</span><span class="fu">apply</span>(df2,<span class="dv">2</span>,mean),</span>
<span id="cb305-6"><a href="estimation.html#cb305-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">n100=</span><span class="fu">apply</span>(df3,<span class="dv">2</span>,mean),<span class="at">n500=</span><span class="fu">apply</span>(df4,<span class="dv">2</span>,mean))</span>
<span id="cb305-7"><a href="estimation.html#cb305-7" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">gather</span>(<span class="at">key=</span><span class="st">&quot;taille_ech&quot;</span>,<span class="at">value=</span>x)</span>
<span id="cb305-8"><a href="estimation.html#cb305-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df1)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>..density..)<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">50</span>)<span class="sc">+</span><span class="fu">facet_wrap</span>(<span class="sc">~</span><span class="fu">fct_relevel</span>(taille_ech,<span class="st">&quot;n20&quot;</span>,<span class="st">&quot;n50&quot;</span>,<span class="st">&quot;n100&quot;</span>,<span class="st">&quot;n500&quot;</span>))<span class="sc">+</span><span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-221-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="corR">
<p>
On remarque que :
</p>
<ul>
<li>
dans tous les cas, la distribution de la moyenne empirique semble être gaussienne et centrée en 0.5 (qui est la valeur à estimer).
</li>
<li>
la dispersion augmente lorsque le nombre d’observations <span class="math inline"><span class="math inline">\(n\)</span></span> diminue (moins précis).
</li>
</ul>
</div>
</div>
<div class="exercise">
<p><span id="exr:exo-TCL2" class="exercise"><strong>Exercice 7.4  (Théorème central limite (toujours)) </strong></span>Faire le même exercice pour une loi gaussienne <span class="math inline">\(\mathcal N(1,2)\)</span> et une loi de Bernoulli <span class="math inline">\(\mathcal B(0.6)\)</span>.</p>
<ul>
<li><div class="corR">
<p>
Pour la loi <span class="math inline"><span class="math inline">\(\mathcal N(1,2)\)</span></span>
</p>
</div>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="estimation.html#cb306-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">20</span><span class="sc">*</span><span class="dv">5000</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">nrow=</span><span class="dv">20</span>) </span>
<span id="cb306-2"><a href="estimation.html#cb306-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">50</span><span class="sc">*</span><span class="dv">5000</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">nrow=</span><span class="dv">50</span>) </span>
<span id="cb306-3"><a href="estimation.html#cb306-3" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">100</span><span class="sc">*</span><span class="dv">5000</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">nrow=</span><span class="dv">100</span>) </span>
<span id="cb306-4"><a href="estimation.html#cb306-4" aria-hidden="true" tabindex="-1"></a>df4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">500</span><span class="sc">*</span><span class="dv">5000</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">nrow=</span><span class="dv">500</span>)</span>
<span id="cb306-5"><a href="estimation.html#cb306-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n20=</span><span class="fu">apply</span>(df1,<span class="dv">2</span>,mean),<span class="at">n50=</span><span class="fu">apply</span>(df2,<span class="dv">2</span>,mean),</span>
<span id="cb306-6"><a href="estimation.html#cb306-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">n100=</span><span class="fu">apply</span>(df3,<span class="dv">2</span>,mean),<span class="at">n500=</span><span class="fu">apply</span>(df4,<span class="dv">2</span>,mean))</span>
<span id="cb306-7"><a href="estimation.html#cb306-7" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">gather</span>(<span class="at">key=</span><span class="st">&quot;taille_ech&quot;</span>,<span class="at">value=</span>x)</span>
<span id="cb306-8"><a href="estimation.html#cb306-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df1)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>..density..)<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">50</span>)<span class="sc">+</span></span>
<span id="cb306-9"><a href="estimation.html#cb306-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span><span class="fu">fct_relevel</span>(taille_ech,<span class="st">&quot;n20&quot;</span>,<span class="st">&quot;n50&quot;</span>,<span class="st">&quot;n100&quot;</span>,<span class="st">&quot;n500&quot;</span>),<span class="at">scales=</span><span class="st">&quot;fixed&quot;</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-224-1.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><div class="corR">
<p>
Pour la <span class="math inline"><span class="math inline">\(\mathcal B(0.6)\)</span></span>
</p>
</div>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="estimation.html#cb307-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">20</span><span class="sc">*</span><span class="dv">50000</span>,<span class="dv">1</span>,<span class="fl">0.6</span>),<span class="at">nrow=</span><span class="dv">20</span>) </span>
<span id="cb307-2"><a href="estimation.html#cb307-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">50</span><span class="sc">*</span><span class="dv">50000</span>,<span class="dv">1</span>,<span class="fl">0.6</span>),<span class="at">nrow=</span><span class="dv">50</span>) </span>
<span id="cb307-3"><a href="estimation.html#cb307-3" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">100</span><span class="sc">*</span><span class="dv">50000</span>,<span class="dv">1</span>,<span class="fl">0.6</span>),<span class="at">nrow=</span><span class="dv">100</span>) </span>
<span id="cb307-4"><a href="estimation.html#cb307-4" aria-hidden="true" tabindex="-1"></a>df4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">500</span><span class="sc">*</span><span class="dv">50000</span>,<span class="dv">1</span>,<span class="fl">0.6</span>),<span class="at">nrow=</span><span class="dv">500</span>)</span>
<span id="cb307-5"><a href="estimation.html#cb307-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n20=</span><span class="fu">apply</span>(df1,<span class="dv">2</span>,mean),<span class="at">n50=</span><span class="fu">apply</span>(df2,<span class="dv">2</span>,mean),</span>
<span id="cb307-6"><a href="estimation.html#cb307-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">n100=</span><span class="fu">apply</span>(df3,<span class="dv">2</span>,mean),<span class="at">n500=</span><span class="fu">apply</span>(df4,<span class="dv">2</span>,mean))</span>
<span id="cb307-7"><a href="estimation.html#cb307-7" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">gather</span>(<span class="at">key=</span><span class="st">&quot;taille_ech&quot;</span>,<span class="at">value=</span>x)</span>
<span id="cb307-8"><a href="estimation.html#cb307-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df1)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>..density..)<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">30</span>)<span class="sc">+</span></span>
<span id="cb307-9"><a href="estimation.html#cb307-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span><span class="fu">fct_relevel</span>(taille_ech,<span class="st">&quot;n20&quot;</span>,<span class="st">&quot;n50&quot;</span>,<span class="st">&quot;n100&quot;</span>,<span class="st">&quot;n500&quot;</span>),<span class="at">scales=</span><span class="st">&quot;fixed&quot;</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-226-1.png" width="672" style="display: block; margin: auto;" /></p></li>
</ul>
<div class="corR">
<p>
Dans tous ces cas, on retrouve bien que la moyenne empirique a une distribution gaussienne autours de la valeur à estimer (l’espérance). La dispersion dépend de :
</p>
<ul>
<li>
la dispersion des observations (de la loi de <span class="math inline"><span class="math inline">\(x_i\)</span></span>) ;
</li>
<li>
du nombre d’observations.
</li>
</ul>
<p>
La moyenne empirique est donc d’autant plus <strong>précise</strong> que la <strong>variance des observations</strong> est petite et que le <strong>nombre d’observations</strong> est grand. Le théorème central limite permet de quantifier tout ça et donc de déduire des intervalles de confiance et de faire des tests…
</p>
</div>
</div>
</div>
</div>
<div id="intervalles-de-confiance" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Intervalles de confiance</h2>
<p>On cherche ici à illustrer numériquement le niveau d’un intervalle de confiance. On rappelle que <span class="math inline">\([A,B]\)</span> est un IC de niveau <span class="math inline">\(1-\alpha\)</span> pour un paramètre <span class="math inline">\(\theta\)</span> si
<span class="math display">\[P(\theta\in[A,B])=1-\alpha.\]</span></p>
<div class="exercise">
<p><span id="exr:exo-ICgaussienne" class="exercise"><strong>Exercice 7.5  (IC pour l'espérance d'une gaussienne) </strong></span>On fixe ici le niveau à 0.95 (<span class="math inline">\(\alpha=0.05\)</span>). On considère <span class="math inline">\(n\)</span> observations <span class="math inline">\(x_1,\dots,x_n\)</span> i.i.d de loi <span class="math inline">\(\mathcal N(\mu,1)\)</span> et on cherche un intervalle de confiance pour <span class="math inline">\(\mu\)</span>.</p>
<ol style="list-style-type: decimal">
<li><p>Générer <span class="math inline">\(n=100\)</span> observations i.i.d. selon la loi <span class="math inline">\(\mathcal N(\mu,1)\)</span> avec <span class="math inline">\(\mu=1\)</span>.</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="estimation.html#cb308-1" aria-hidden="true" tabindex="-1"></a>ech <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span></code></pre></div></li>
<li><p>Calculer un intervalle de confiance pour <span class="math inline">\(\mu\)</span> de niveau 0.95.</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="estimation.html#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(ech)<span class="sc">$</span>conf.int</span>
<span id="cb309-2"><a href="estimation.html#cb309-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.8038101</span> <span class="fl">1.2314117</span></span>
<span id="cb309-3"><a href="estimation.html#cb309-3" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(,<span class="st">&quot;conf.level&quot;</span>)</span>
<span id="cb309-4"><a href="estimation.html#cb309-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.95</span></span></code></pre></div></li>
<li><p>Selon-vous, peut-on dire que la probabilité que <span class="math inline">\(\mu\)</span> appartienne à l’intervalle trouvé est de 0.95 ? Si non, comment peut-on interpréter cette formule.</p>
<div class="corR">
<p>
<strong>Non</strong>. Dans notre cas, <span class="math inline"><span class="math inline">\(\mu\)</span></span> (qui vaut 1) appartient à l’intervalle trouvé. Dans la vraie vie, <strong><span class="math inline"><span class="math inline">\(\mu\)</span></span> est inconnu</strong>. Ce que la formule nous dit, c’est que si nos données sont issues d’un loi <span class="math inline"><span class="math inline">\(\mathcal N(\mu,\sigma^2)\)</span></span>, on a une probabilité de 0.95 que <span class="math inline"><span class="math inline">\(\mu\)</span></span> appartienne à l’intervalle trouvé. Donc si on génère un très grand nombre d’échantillon i.i.d selon la loi <span class="math inline"><span class="math inline">\(\mathcal N(\mu,\sigma^2)\)</span></span>, alors dans 95% des cas, la vraie valeur de <span class="math inline"><span class="math inline">\(\mu\)</span></span> appartiendra à l’intervalle trouvé. C’est ce qu’on propose de vérifier dans les questions suivantes.
</p>
</div></li>
<li><p>Générer 5000 échantillons i.i.d. de loi <span class="math inline">\(\mathcal N(1,1)\)</span> de tailles 100. On pourra mettre le tout dans une matrice de dimension <span class="math inline">\(5000\times 100\)</span>.</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="estimation.html#cb310-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb310-2"><a href="estimation.html#cb310-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb310-3"><a href="estimation.html#cb310-3" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb310-4"><a href="estimation.html#cb310-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n<span class="sc">*</span>B,<span class="at">mean=</span>mu),<span class="at">nrow=</span>B)</span></code></pre></div></li>
<li><p>Calculer un intervalle de confiance de niveau 0.95 pour chacun des 5000 échantillons. On pourra utiliser une boucle <strong>for</strong> ou la fonction <strong>apply</strong>.</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="estimation.html#cb311-1" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">apply</span>(X,<span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">t.test</span>(x)<span class="sc">$</span>conf.int[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span></code></pre></div></li>
<li><p>Sur les 5000 intervalles obtenus, calculer le nombre de fois où la vraie valeur de <span class="math inline">\(\mu\)</span> (en l’occcurence ici 1) se trouve à l’intérieur de l’intervalle.</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="estimation.html#cb312-1" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(b1))</span>
<span id="cb312-2"><a href="estimation.html#cb312-2" aria-hidden="true" tabindex="-1"></a>b2 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">test=</span>mu<span class="sc">&gt;</span>V1 <span class="sc">&amp;</span> mu<span class="sc">&lt;</span>V2) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="fu">mean</span>(test))</span>
<span id="cb312-3"><a href="estimation.html#cb312-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(test)</span>
<span id="cb312-4"><a href="estimation.html#cb312-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>     <span class="fl">0.9494</span></span></code></pre></div></li>
<li><p>Refaire les questions 5-6-7 avec des IC de niveau 0.90.</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="estimation.html#cb313-1" aria-hidden="true" tabindex="-1"></a>c1 <span class="ot">&lt;-</span> <span class="fu">apply</span>(X,<span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">t.test</span>(x,<span class="at">conf.level=</span><span class="fl">0.90</span>)<span class="sc">$</span>conf.int[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb313-2"><a href="estimation.html#cb313-2" aria-hidden="true" tabindex="-1"></a>c2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(c1))</span>
<span id="cb313-3"><a href="estimation.html#cb313-3" aria-hidden="true" tabindex="-1"></a>c2 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">test=</span>mu<span class="sc">&gt;</span>V1 <span class="sc">&amp;</span> mu<span class="sc">&lt;</span>V2) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="fu">mean</span>(test))</span>
<span id="cb313-4"><a href="estimation.html#cb313-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(test)</span>
<span id="cb313-5"><a href="estimation.html#cb313-5" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>      <span class="fl">0.898</span></span></code></pre></div></li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:exo-ICiris" class="exercise"><strong>Exercice 7.6  (IC pour les iris de Fisher) </strong></span>On considère les données sur les iris de Fisher. Construire un intervalle de confiance de niveau 90% pour les paramètres suivants :</p>
<ul>
<li><p>La longueur de Pétales moyenne</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="estimation.html#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(iris<span class="sc">$</span>Petal.Length,<span class="at">conf.level=</span><span class="fl">0.90</span>)<span class="sc">$</span>conf.int</span>
<span id="cb314-2"><a href="estimation.html#cb314-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">3.519434</span> <span class="fl">3.996566</span></span>
<span id="cb314-3"><a href="estimation.html#cb314-3" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(,<span class="st">&quot;conf.level&quot;</span>)</span>
<span id="cb314-4"><a href="estimation.html#cb314-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.9</span></span></code></pre></div></li>
<li><p>La largeur de Sépales moyenne de l’espèce Setosa</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="estimation.html#cb315-1" aria-hidden="true" tabindex="-1"></a>sep_set <span class="ot">&lt;-</span> iris <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Species<span class="sc">==</span><span class="st">&quot;setosa&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Sepal.Width) </span>
<span id="cb315-2"><a href="estimation.html#cb315-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(sep_set,<span class="at">conf.level=</span><span class="fl">0.90</span>)<span class="sc">$</span>conf.int</span>
<span id="cb315-3"><a href="estimation.html#cb315-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">3.338124</span> <span class="fl">3.517876</span></span>
<span id="cb315-4"><a href="estimation.html#cb315-4" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(,<span class="st">&quot;conf.level&quot;</span>)</span>
<span id="cb315-5"><a href="estimation.html#cb315-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.9</span></span>
<span id="cb315-6"><a href="estimation.html#cb315-6" aria-hidden="true" tabindex="-1"></a><span class="co">#ou</span></span>
<span id="cb315-7"><a href="estimation.html#cb315-7" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Species<span class="sc">==</span><span class="st">&quot;setosa&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb315-8"><a href="estimation.html#cb315-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Sepal.Width) <span class="sc">%&gt;%</span> <span class="fu">t.test</span>(<span class="at">conf.level=</span><span class="fl">0.9</span>)</span>
<span id="cb315-9"><a href="estimation.html#cb315-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-10"><a href="estimation.html#cb315-10" aria-hidden="true" tabindex="-1"></a>    One Sample t<span class="sc">-</span>test</span>
<span id="cb315-11"><a href="estimation.html#cb315-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-12"><a href="estimation.html#cb315-12" aria-hidden="true" tabindex="-1"></a>data<span class="sc">:</span>  .</span>
<span id="cb315-13"><a href="estimation.html#cb315-13" aria-hidden="true" tabindex="-1"></a>t <span class="ot">=</span> <span class="fl">63.946</span>, df <span class="ot">=</span> <span class="dv">49</span>, p<span class="sc">-</span>value <span class="sc">&lt;</span> <span class="fl">2.2e-16</span></span>
<span id="cb315-14"><a href="estimation.html#cb315-14" aria-hidden="true" tabindex="-1"></a>alternative hypothesis<span class="sc">:</span> true mean is not equal to <span class="dv">0</span></span>
<span id="cb315-15"><a href="estimation.html#cb315-15" aria-hidden="true" tabindex="-1"></a><span class="dv">90</span> percent confidence interval<span class="sc">:</span></span>
<span id="cb315-16"><a href="estimation.html#cb315-16" aria-hidden="true" tabindex="-1"></a> <span class="fl">3.338124</span> <span class="fl">3.517876</span></span>
<span id="cb315-17"><a href="estimation.html#cb315-17" aria-hidden="true" tabindex="-1"></a>sample estimates<span class="sc">:</span></span>
<span id="cb315-18"><a href="estimation.html#cb315-18" aria-hidden="true" tabindex="-1"></a>mean of x </span>
<span id="cb315-19"><a href="estimation.html#cb315-19" aria-hidden="true" tabindex="-1"></a>    <span class="fl">3.428</span> </span></code></pre></div></li>
<li><p>La largeur de Sépales moyenne des espèces Versicolor et Virginica</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="estimation.html#cb316-1" aria-hidden="true" tabindex="-1"></a>sep_vervin <span class="ot">&lt;-</span> iris <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Species<span class="sc">==</span><span class="st">&quot;versicolor&quot;</span> <span class="sc">|</span> Species <span class="sc">==</span><span class="st">&quot;virginica&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Sepal.Width) </span>
<span id="cb316-2"><a href="estimation.html#cb316-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(sep_vervin,<span class="at">conf.level=</span><span class="fl">0.90</span>)<span class="sc">$</span>conf.int</span>
<span id="cb316-3"><a href="estimation.html#cb316-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">2.81675</span> <span class="fl">2.92725</span></span>
<span id="cb316-4"><a href="estimation.html#cb316-4" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(,<span class="st">&quot;conf.level&quot;</span>)</span>
<span id="cb316-5"><a href="estimation.html#cb316-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.9</span></span></code></pre></div></li>
</ul>
</div>
<div class="exercise">
<p><span id="exr:exo-ICproportion" class="exercise"><strong>Exercice 7.7  (IC pour une proportion) </strong></span>On considère <span class="math inline">\(x_1,\dots,x_n\)</span> un échantillon i.i.d issu d’une loi de Bernoulli de paramètre <span class="math inline">\(p\in[0,1]\)</span> inconnu.</p>
<ol style="list-style-type: decimal">
<li><p>Proposer un estimateur <span class="math inline">\(\widehat p\)</span> pour <span class="math inline">\(p\)</span>.</p>
<div class="corR">
<p>
On peut prendre <span class="math display"><span class="math display">\[\widehat p=\bar x_n=\frac{1}{n}\sum_{i=1}^nx_i.\]</span></span>
</p>
</div></li>
<li><p>A l’aide du TCL, obtenir la loi asymptotique de <span class="math inline">\(\hat p\)</span>.</p>
<div class="corR">
<p>
On a d’après la TCL
</p>
<p>
<span class="math display"><span class="math display">\[\sqrt{n}\frac{\widehat{p}-p}{\sqrt{p(1-p)}}\stackrel{\mathcal L}{\to}\mathcal N(0,1)\]</span></span>
</p>
</div></li>
<li><p>En déduire un intervalle de confiance de niveau <span class="math inline">\(1-\alpha\)</span> pour <span class="math inline">\(p\)</span>.</p>
<div class="corR">
<p>
On déduit que <span class="math display"><span class="math display">\[\left[\widehat p-q_{1-\alpha/2}\sqrt{\frac{p(1-p)}{n}}, \widehat p+q_{1-\alpha/2}\sqrt{\frac{p(1-p)}{n}}\right].\]</span></span>
</p>
<p>
est un IC de niveau <span class="math inline"><span class="math inline">\(1-\alpha\)</span></span>.
</p>
</div></li>
<li><p>Que pouvez-vous reprocher à l’intervalle proposé à la question précédente ?</p>
<div class="corR">
<p>
L’IC proposé dépend de <span class="math inline"><span class="math inline">\(p\)</span></span> qui est inconnu ! Il ne sera donc pas calculable en pratique !
</p>
</div></li>
<li><p>Proposer une solution.</p>
<div class="corR">
<p>
Un solution classique consiste à remplacer le paramètre <span class="math inline"><span class="math inline">\(p\)</span></span> inconnu par son estimateur <span class="math inline"><span class="math inline">\(\widehat p\)</span></span>. On obtient ainsi l’IC <span class="math display"><span class="math display">\[\left[\widehat p-q_{1-\alpha/2}\sqrt{\frac{\widehat p(1-\widehat p)}{n}}, \widehat p+q_{1-\alpha/2}\sqrt{\frac{\widehat p(1-\widehat p)}{n}}\right].\]</span></span>
</p>
</div></li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:exo-ICproportion2" class="exercise"><strong>Exercice 7.8  (IC pour une proportion (suite)) </strong></span>Afin de tenter de deviner qui va gagner une élection entre deux candidats <span class="math inline">\(A\)</span> et <span class="math inline">\(B\)</span> on effectue un sondage. On demande à 100 personnes pour qui elles vont voter. Les résultats sont reportés dans le vecteur suivant.</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="estimation.html#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb317-2"><a href="estimation.html#cb317-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">100</span>,<span class="dv">1</span>,<span class="fl">0.52</span>)</span></code></pre></div>
<p>On désigne par <span class="math inline">\(p\)</span> la propotion (inconnue) d’électeurs qui vont voter pour <span class="math inline">\(A\)</span>.</p>
<ol style="list-style-type: decimal">
<li><p>Proposer et calculer un estimateur de <span class="math inline">\(p\)</span>.</p>
<div class="corR">
<p>
On peut prendre la moyenne empirique <span class="math display"><span class="math display">\[\widehat p=\bar x_n=\frac{1}{n}\sum_{i=1}^nx_i.\]</span></span> On la calcule avec
</p>
</div>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="estimation.html#cb318-1" aria-hidden="true" tabindex="-1"></a>phat <span class="ot">&lt;-</span> <span class="fu">mean</span>(res)</span>
<span id="cb318-2"><a href="estimation.html#cb318-2" aria-hidden="true" tabindex="-1"></a>phat</span>
<span id="cb318-3"><a href="estimation.html#cb318-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.54</span></span></code></pre></div></li>
<li><p>Que pouvez-vous conclure a priori.</p>
<div class="corR">
<p>
Il semble que <span class="math inline"><span class="math inline">\(A\)</span></span> va remporter l’élection.
</p>
</div></li>
<li><p>En vous basant sur l’exercice précédent, calculer un intervalle de confiance de niveau 95% pour <span class="math inline">\(p\)</span>.</p>
<div class="corR">
<p>
On le calcule avec
</p>
</div>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="estimation.html#cb319-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(res)</span>
<span id="cb319-2"><a href="estimation.html#cb319-2" aria-hidden="true" tabindex="-1"></a>binf <span class="ot">&lt;-</span> phat<span class="sc">-</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>)<span class="sc">*</span><span class="fu">sqrt</span>(phat<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>phat)<span class="sc">/</span>n)</span>
<span id="cb319-3"><a href="estimation.html#cb319-3" aria-hidden="true" tabindex="-1"></a>bsup <span class="ot">&lt;-</span> phat<span class="sc">+</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>)<span class="sc">*</span><span class="fu">sqrt</span>(phat<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>phat)<span class="sc">/</span>n)</span>
<span id="cb319-4"><a href="estimation.html#cb319-4" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(binf,bsup)</span>
<span id="cb319-5"><a href="estimation.html#cb319-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.4423159</span> <span class="fl">0.6376841</span></span></code></pre></div></li>
<li><p>Est-ce que l’intervalle obtenu conforte votre conclusion de la question 2 ?</p>
<div class="corR">
<p>
Non, en effet 0.5 se trouve dans l’intervalle de confiance !
</p>
</div></li>
<li><p>Calculer un intervalle de confiance pour <span class="math inline">\(p\)</span> à l’aide de la fonction <strong>prop.test</strong>.</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="estimation.html#cb320-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.test</span>(<span class="fu">sum</span>(res),n)</span>
<span id="cb320-2"><a href="estimation.html#cb320-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-3"><a href="estimation.html#cb320-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">-</span>sample proportions test with continuity correction</span>
<span id="cb320-4"><a href="estimation.html#cb320-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-5"><a href="estimation.html#cb320-5" aria-hidden="true" tabindex="-1"></a>data<span class="sc">:</span>  <span class="fu">sum</span>(res) out of n, null probability <span class="fl">0.5</span></span>
<span id="cb320-6"><a href="estimation.html#cb320-6" aria-hidden="true" tabindex="-1"></a>X<span class="sc">-</span>squared <span class="ot">=</span> <span class="fl">0.49</span>, df <span class="ot">=</span> <span class="dv">1</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.4839</span></span>
<span id="cb320-7"><a href="estimation.html#cb320-7" aria-hidden="true" tabindex="-1"></a>alternative hypothesis<span class="sc">:</span> true p is not equal to <span class="fl">0.5</span></span>
<span id="cb320-8"><a href="estimation.html#cb320-8" aria-hidden="true" tabindex="-1"></a><span class="dv">95</span> percent confidence interval<span class="sc">:</span></span>
<span id="cb320-9"><a href="estimation.html#cb320-9" aria-hidden="true" tabindex="-1"></a> <span class="fl">0.4377639</span> <span class="fl">0.6391280</span></span>
<span id="cb320-10"><a href="estimation.html#cb320-10" aria-hidden="true" tabindex="-1"></a>sample estimates<span class="sc">:</span></span>
<span id="cb320-11"><a href="estimation.html#cb320-11" aria-hidden="true" tabindex="-1"></a>   p </span>
<span id="cb320-12"><a href="estimation.html#cb320-12" aria-hidden="true" tabindex="-1"></a><span class="fl">0.54</span> </span></code></pre></div>
<div class="corR">
<p>
On remarque que l’IC obtenu ne correspond pas exactement à celui que nous avons calculé à la question 3. La fonction <strong>prop.test</strong> utilise une solution plus pertinente que de remplacer <span class="math inline"><span class="math inline">\(p\)</span></span> par son estimateur. La correction utilisée dans <strong>prop.test</strong> est plus préciser, il est recommandé d’utiliser celle là.
</p>
</div></li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:exo-compmoyenne" class="exercise"><strong>Exercice 7.9  (Comparaison de moyennes) </strong></span>Pour le jeu de données <code>decathlon</code> disponible ici</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="estimation.html#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FactoMineR)</span>
<span id="cb321-2"><a href="estimation.html#cb321-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(decathlon)</span></code></pre></div>
<p>on souhaite comparer les performances au 100m en fonction de la compétition (Decastar vs JO).</p>
<ol style="list-style-type: decimal">
<li><p>Calculer un intervalle de confiance de niveau 95% pour la vitesse moyenne au 100m au Decastar.</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="estimation.html#cb322-1" aria-hidden="true" tabindex="-1"></a>perf.D <span class="ot">&lt;-</span> decathlon <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Competition<span class="sc">==</span><span class="st">&quot;Decastar&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">`</span><span class="at">100m</span><span class="st">`</span>)</span>
<span id="cb322-2"><a href="estimation.html#cb322-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(perf.D)</span>
<span id="cb322-3"><a href="estimation.html#cb322-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb322-4"><a href="estimation.html#cb322-4" aria-hidden="true" tabindex="-1"></a>    One Sample t<span class="sc">-</span>test</span>
<span id="cb322-5"><a href="estimation.html#cb322-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb322-6"><a href="estimation.html#cb322-6" aria-hidden="true" tabindex="-1"></a>data<span class="sc">:</span>  perf.D</span>
<span id="cb322-7"><a href="estimation.html#cb322-7" aria-hidden="true" tabindex="-1"></a>t <span class="ot">=</span> <span class="fl">163.64</span>, df <span class="ot">=</span> <span class="dv">12</span>, p<span class="sc">-</span>value <span class="sc">&lt;</span> <span class="fl">2.2e-16</span></span>
<span id="cb322-8"><a href="estimation.html#cb322-8" aria-hidden="true" tabindex="-1"></a>alternative hypothesis<span class="sc">:</span> true mean is not equal to <span class="dv">0</span></span>
<span id="cb322-9"><a href="estimation.html#cb322-9" aria-hidden="true" tabindex="-1"></a><span class="dv">95</span> percent confidence interval<span class="sc">:</span></span>
<span id="cb322-10"><a href="estimation.html#cb322-10" aria-hidden="true" tabindex="-1"></a> <span class="fl">11.02659</span> <span class="fl">11.32418</span></span>
<span id="cb322-11"><a href="estimation.html#cb322-11" aria-hidden="true" tabindex="-1"></a>sample estimates<span class="sc">:</span></span>
<span id="cb322-12"><a href="estimation.html#cb322-12" aria-hidden="true" tabindex="-1"></a>mean of x </span>
<span id="cb322-13"><a href="estimation.html#cb322-13" aria-hidden="true" tabindex="-1"></a> <span class="fl">11.17538</span> </span></code></pre></div></li>
<li><p>Même question pour les jeux olympiques.</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="estimation.html#cb323-1" aria-hidden="true" tabindex="-1"></a>perf.JO <span class="ot">&lt;-</span> decathlon <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Competition<span class="sc">==</span><span class="st">&quot;OlympicG&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">`</span><span class="at">100m</span><span class="st">`</span>)</span>
<span id="cb323-2"><a href="estimation.html#cb323-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(perf.JO)</span>
<span id="cb323-3"><a href="estimation.html#cb323-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-4"><a href="estimation.html#cb323-4" aria-hidden="true" tabindex="-1"></a>    One Sample t<span class="sc">-</span>test</span>
<span id="cb323-5"><a href="estimation.html#cb323-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-6"><a href="estimation.html#cb323-6" aria-hidden="true" tabindex="-1"></a>data<span class="sc">:</span>  perf.JO</span>
<span id="cb323-7"><a href="estimation.html#cb323-7" aria-hidden="true" tabindex="-1"></a>t <span class="ot">=</span> <span class="fl">250.02</span>, df <span class="ot">=</span> <span class="dv">27</span>, p<span class="sc">-</span>value <span class="sc">&lt;</span> <span class="fl">2.2e-16</span></span>
<span id="cb323-8"><a href="estimation.html#cb323-8" aria-hidden="true" tabindex="-1"></a>alternative hypothesis<span class="sc">:</span> true mean is not equal to <span class="dv">0</span></span>
<span id="cb323-9"><a href="estimation.html#cb323-9" aria-hidden="true" tabindex="-1"></a><span class="dv">95</span> percent confidence interval<span class="sc">:</span></span>
<span id="cb323-10"><a href="estimation.html#cb323-10" aria-hidden="true" tabindex="-1"></a> <span class="fl">10.82613</span> <span class="fl">11.00530</span></span>
<span id="cb323-11"><a href="estimation.html#cb323-11" aria-hidden="true" tabindex="-1"></a>sample estimates<span class="sc">:</span></span>
<span id="cb323-12"><a href="estimation.html#cb323-12" aria-hidden="true" tabindex="-1"></a>mean of x </span>
<span id="cb323-13"><a href="estimation.html#cb323-13" aria-hidden="true" tabindex="-1"></a> <span class="fl">10.91571</span> </span></code></pre></div></li>
<li><p>Pouvez-vous conclure sur la question posée ? Si non, que faire ?</p>
<div class="corR">
<p>
Il n’est pas possible de conclure. La bonne approche consiste à calculer un intervalle de confiance sur la différence moyenne des performances au 100m entre les deux compétitions et de regarder si 0 se situe dans l’intervalle.
</p>
<p>
On obtient l’intervalle avec
</p>
</div>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="estimation.html#cb324-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(perf.D,perf.JO)</span>
<span id="cb324-2"><a href="estimation.html#cb324-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-3"><a href="estimation.html#cb324-3" aria-hidden="true" tabindex="-1"></a>    Welch Two Sample t<span class="sc">-</span>test</span>
<span id="cb324-4"><a href="estimation.html#cb324-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-5"><a href="estimation.html#cb324-5" aria-hidden="true" tabindex="-1"></a>data<span class="sc">:</span>  perf.D and perf.JO</span>
<span id="cb324-6"><a href="estimation.html#cb324-6" aria-hidden="true" tabindex="-1"></a>t <span class="ot">=</span> <span class="fl">3.2037</span>, df <span class="ot">=</span> <span class="fl">22.168</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.00407</span></span>
<span id="cb324-7"><a href="estimation.html#cb324-7" aria-hidden="true" tabindex="-1"></a>alternative hypothesis<span class="sc">:</span> true difference <span class="cf">in</span> means is not equal to <span class="dv">0</span></span>
<span id="cb324-8"><a href="estimation.html#cb324-8" aria-hidden="true" tabindex="-1"></a><span class="dv">95</span> percent confidence interval<span class="sc">:</span></span>
<span id="cb324-9"><a href="estimation.html#cb324-9" aria-hidden="true" tabindex="-1"></a> <span class="fl">0.09164794</span> <span class="fl">0.42769272</span></span>
<span id="cb324-10"><a href="estimation.html#cb324-10" aria-hidden="true" tabindex="-1"></a>sample estimates<span class="sc">:</span></span>
<span id="cb324-11"><a href="estimation.html#cb324-11" aria-hidden="true" tabindex="-1"></a>mean of x mean of y </span>
<span id="cb324-12"><a href="estimation.html#cb324-12" aria-hidden="true" tabindex="-1"></a> <span class="fl">11.17538</span>  <span class="fl">10.91571</span> </span></code></pre></div>
<div class="corR">
<p>
0 n’étant pas dans l’intervalle, on conclut que les performances sont différentes. On verra par la suite que les tests d’hypothèses permettent de traiter ce genre de questions de façons plus efficace.
</p>
</div></li>
</ol>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="faire-de-la-régression-sur-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="références.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "sepia",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["TUTO_R.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"sharing": {
"facebook": true,
"github": true,
"twitter": true
}
},
"highlight": "tango"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
