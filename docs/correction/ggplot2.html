<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 4 Visualisation avec ggplot2 | Introduction à R et à la modélisation statistique</title>
  <meta name="description" content="Chapitre 4 Visualisation avec ggplot2 | Introduction à R et à la modélisation statistique" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 4 Visualisation avec ggplot2 | Introduction à R et à la modélisation statistique" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 4 Visualisation avec ggplot2 | Introduction à R et à la modélisation statistique" />
  
  
  

<meta name="author" content="Laurent Rouvière" />


<meta name="date" content="2021-10-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="dplyr.html"/>
<link rel="next" href="leaflet.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/amcharts-3.21.13/amcharts.js"></script>
<script src="libs/ramcharts_base-binding-2.1.13/ramcharts_base.js"></script>
<script src="libs/amcharts_type_serial-3.20.18/serial.js"></script>
<script src="libs/amcharts_themes_light.js-3.20.18/light.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script>
<link href="libs/vis-9.1.0/vis-network.min.css" rel="stylesheet" />
<script src="libs/vis-9.1.0/vis-network.min.js"></script>
<script src="libs/visNetwork-binding-2.1.0/visNetwork.js"></script>
<script src="libs/FileSaver-1.1.20151003/FileSaver.min.js"></script>
<script src="libs/Blob-1.0/Blob.js"></script>
<script src="libs/canvas-toBlob-1.0/canvas-toBlob.js"></script>
<script src="libs/html2canvas-0.5.0/html2canvas.js"></script>
<script src="libs/jspdf-1.3.2/jspdf.debug.js"></script>
<link href="libs/jquery-sparkline-2.1.2/jquery.sparkline.css" rel="stylesheet" />
<script src="libs/jquery-sparkline-2.1.2/jquery.sparkline.js"></script>
<script src="libs/sparkline-binding-2.0/sparkline.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction à R<br> <br> L. Rouvière</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Présentation</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#r-script"><i class="fa fa-check"></i><b>1.1</b> R Script</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#packages"><i class="fa fa-check"></i><b>1.2</b> Packages</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#markdown"><i class="fa fa-check"></i><b>1.3</b> Markdown</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="intro.html"><a href="intro.html#syntaxe"><i class="fa fa-check"></i><b>1.3.1</b> Syntaxe</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro.html"><a href="intro.html#les-chunks"><i class="fa fa-check"></i><b>1.3.2</b> Les chunks</a></li>
<li class="chapter" data-level="1.3.3" data-path="intro.html"><a href="intro.html#notebook"><i class="fa fa-check"></i><b>1.3.3</b> Notebook</a></li>
<li class="chapter" data-level="1.3.4" data-path="intro.html"><a href="intro.html#diaporama-r"><i class="fa fa-check"></i><b>1.3.4</b> Diaporama R</a></li>
<li class="chapter" data-level="1.3.5" data-path="intro.html"><a href="intro.html#exemples-de-styles-de-documents-markdown"><i class="fa fa-check"></i><b>1.3.5</b> Exemples de styles de documents markdown</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="objetsR.html"><a href="objetsR.html"><i class="fa fa-check"></i><b>2</b> Les objets R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="objetsR.html"><a href="objetsR.html#création-dobjets"><i class="fa fa-check"></i><b>2.1</b> Création d’objets</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="objetsR.html"><a href="objetsR.html#numérique"><i class="fa fa-check"></i><b>2.1.1</b> Numérique</a></li>
<li class="chapter" data-level="2.1.2" data-path="objetsR.html"><a href="objetsR.html#caractère"><i class="fa fa-check"></i><b>2.1.2</b> Caractère</a></li>
<li class="chapter" data-level="2.1.3" data-path="objetsR.html"><a href="objetsR.html#facteur"><i class="fa fa-check"></i><b>2.1.3</b> Facteur</a></li>
<li class="chapter" data-level="2.1.4" data-path="objetsR.html"><a href="objetsR.html#logique-booléen"><i class="fa fa-check"></i><b>2.1.4</b> Logique (Booléen)</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="objetsR.html"><a href="objetsR.html#vecteur"><i class="fa fa-check"></i><b>2.2</b> Vecteur</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="objetsR.html"><a href="objetsR.html#sélectionner-une-partie-dun-vecteur"><i class="fa fa-check"></i><b>2.2.1</b> Sélectionner une partie d’un vecteur</a></li>
<li class="chapter" data-level="2.2.2" data-path="objetsR.html"><a href="objetsR.html#opérations-sur-les-vecteurs"><i class="fa fa-check"></i><b>2.2.2</b> Opérations sur les vecteurs</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="objetsR.html"><a href="objetsR.html#matrices"><i class="fa fa-check"></i><b>2.3</b> Matrices</a></li>
<li class="chapter" data-level="2.4" data-path="objetsR.html"><a href="objetsR.html#listes"><i class="fa fa-check"></i><b>2.4</b> Listes</a></li>
<li class="chapter" data-level="2.5" data-path="objetsR.html"><a href="objetsR.html#dataframe"><i class="fa fa-check"></i><b>2.5</b> Dataframe</a></li>
<li class="chapter" data-level="2.6" data-path="objetsR.html"><a href="objetsR.html#quelques-fonctions-importantes"><i class="fa fa-check"></i><b>2.6</b> Quelques fonctions importantes</a></li>
<li class="chapter" data-level="2.7" data-path="objetsR.html"><a href="objetsR.html#exercices-complémentaires"><i class="fa fa-check"></i><b>2.7</b> Exercices complémentaires</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>3</b> Manipuler les données avec dplyr</a>
<ul>
<li class="chapter" data-level="3.1" data-path="dplyr.html"><a href="dplyr.html#importer-des-données"><i class="fa fa-check"></i><b>3.1</b> Importer des données</a></li>
<li class="chapter" data-level="3.2" data-path="dplyr.html"><a href="dplyr.html#le-package-dplyr"><i class="fa fa-check"></i><b>3.2</b> Le package dplyr</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="dplyr.html"><a href="dplyr.html#les-principaux-verbres-dplyr"><i class="fa fa-check"></i><b>3.2.1</b> Les principaux verbres dplyr</a></li>
<li class="chapter" data-level="3.2.2" data-path="dplyr.html"><a href="dplyr.html#les-verbes-summarize-et-groub_by"><i class="fa fa-check"></i><b>3.2.2</b> Les verbes <code>summarize</code> et <code>groub_by</code></a></li>
<li class="chapter" data-level="3.2.3" data-path="dplyr.html"><a href="dplyr.html#assembler-des-verbes-avec-lopérateur-de-chainage"><i class="fa fa-check"></i><b>3.2.3</b> Assembler des verbes avec l’opérateur de chainage <code>%&gt;%</code></a></li>
<li class="chapter" data-level="3.2.4" data-path="dplyr.html"><a href="dplyr.html#quelques-exercices"><i class="fa fa-check"></i><b>3.2.4</b> Quelques exercices</a></li>
<li class="chapter" data-level="3.2.5" data-path="dplyr.html"><a href="dplyr.html#compléments-tidy-data-avec-tidyr"><i class="fa fa-check"></i><b>3.2.5</b> Compléments : Tidy data avec tidyr</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>4</b> Visualisation avec ggplot2</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ggplot2.html"><a href="ggplot2.html#fonctions-graphiques-conventionnelles"><i class="fa fa-check"></i><b>4.1</b> Fonctions graphiques conventionnelles</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="ggplot2.html"><a href="ggplot2.html#la-fonction-plot"><i class="fa fa-check"></i><b>4.1.1</b> La fonction <strong>plot</strong></a></li>
<li class="chapter" data-level="4.1.2" data-path="ggplot2.html"><a href="ggplot2.html#graphes-interactifs-avec-ramcharts"><i class="fa fa-check"></i><b>4.1.2</b> Graphes interactifs avec rAmCharts</a></li>
<li class="chapter" data-level="4.1.3" data-path="ggplot2.html"><a href="ggplot2.html#quelques-exercices-1"><i class="fa fa-check"></i><b>4.1.3</b> Quelques exercices</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="ggplot2.html"><a href="ggplot2.html#la-grammaire-ggplot2"><i class="fa fa-check"></i><b>4.2</b> La grammaire <strong>ggplot2</strong></a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="ggplot2.html"><a href="ggplot2.html#premiers-graphes-ggplot2"><i class="fa fa-check"></i><b>4.2.1</b> Premiers graphes <code>ggplot2</code></a></li>
<li class="chapter" data-level="4.2.2" data-path="ggplot2.html"><a href="ggplot2.html#data-et-aesthetics"><i class="fa fa-check"></i><b>4.2.2</b> Data et aesthetics</a></li>
<li class="chapter" data-level="4.2.3" data-path="ggplot2.html"><a href="ggplot2.html#geometrics"><i class="fa fa-check"></i><b>4.2.3</b> Geometrics</a></li>
<li class="chapter" data-level="4.2.4" data-path="ggplot2.html"><a href="ggplot2.html#statistics"><i class="fa fa-check"></i><b>4.2.4</b> Statistics</a></li>
<li class="chapter" data-level="4.2.5" data-path="ggplot2.html"><a href="ggplot2.html#scales"><i class="fa fa-check"></i><b>4.2.5</b> Scales</a></li>
<li class="chapter" data-level="4.2.6" data-path="ggplot2.html"><a href="ggplot2.html#group-et-facets"><i class="fa fa-check"></i><b>4.2.6</b> Group et facets</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="ggplot2.html"><a href="ggplot2.html#compléments"><i class="fa fa-check"></i><b>4.3</b> Compléments</a></li>
<li class="chapter" data-level="4.4" data-path="ggplot2.html"><a href="ggplot2.html#quelques-exercices-supplémentaires"><i class="fa fa-check"></i><b>4.4</b> Quelques exercices supplémentaires</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="leaflet.html"><a href="leaflet.html"><i class="fa fa-check"></i><b>5</b> Faire des cartes interactives avec leaflet</a>
<ul>
<li class="chapter" data-level="5.1" data-path="leaflet.html"><a href="leaflet.html#présentation-de-leaflet"><i class="fa fa-check"></i><b>5.1</b> Présentation de leaflet</a></li>
<li class="chapter" data-level="5.2" data-path="leaflet.html"><a href="leaflet.html#challenge-visualisation-des-stations-velib-à-paris"><i class="fa fa-check"></i><b>5.2</b> Challenge : Visualisation des stations velib à Paris</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="faire-de-la-régression-sur-r.html"><a href="faire-de-la-régression-sur-r.html"><i class="fa fa-check"></i><b>6</b> Faire de la régression sur R</a>
<ul>
<li class="chapter" data-level="6.1" data-path="faire-de-la-régression-sur-r.html"><a href="faire-de-la-régression-sur-r.html#modèle-linéaire-fonctions-lm-et-predict"><i class="fa fa-check"></i><b>6.1</b> Modèle linéaire : fonctions lm et predict</a></li>
<li class="chapter" data-level="6.2" data-path="faire-de-la-régression-sur-r.html"><a href="faire-de-la-régression-sur-r.html#sélection-de-variables"><i class="fa fa-check"></i><b>6.2</b> Sélection de variables</a></li>
<li class="chapter" data-level="6.3" data-path="faire-de-la-régression-sur-r.html"><a href="faire-de-la-régression-sur-r.html#régression-logistique-et-arbre"><i class="fa fa-check"></i><b>6.3</b> Régression logistique et arbre</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="estimation.html"><a href="estimation.html"><i class="fa fa-check"></i><b>7</b> Estimation et intervalles de confiance</a>
<ul>
<li class="chapter" data-level="7.1" data-path="estimation.html"><a href="estimation.html#générer-des-observations-selon-des-lois-de-probabilités"><i class="fa fa-check"></i><b>7.1</b> Générer des observations selon des lois de probabilités</a></li>
<li class="chapter" data-level="7.2" data-path="estimation.html"><a href="estimation.html#une-étude-numérique-de-la-moyenne-empirique."><i class="fa fa-check"></i><b>7.2</b> Une étude numérique de la moyenne empirique.</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="estimation.html"><a href="estimation.html#exemple"><i class="fa fa-check"></i><b>7.2.1</b> Exemple</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="estimation.html"><a href="estimation.html#intervalles-de-confiance"><i class="fa fa-check"></i><b>7.3</b> Intervalles de confiance</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="références.html"><a href="références.html"><i class="fa fa-check"></i>Références</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction à R et à la modélisation statistique</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ggplot2" class="section level1" number="4">
<h1><span class="header-section-number">Chapitre 4</span> Visualisation avec ggplot2</h1>
<p>Il est souvent nécessaire d’utiliser des techniques de visualisation au cours des différentes étapes d’un projet en science des données. Un des avantages de <strong>R</strong> est qu’il est relativement simple de mettre en œuvre tous les types de graphes généralement utilisés. Dans cette partie, nous présentons tout d’abord les fonctions classiques qui permettent de tracer des figures. Nous proposons ensuite une introduction aux graphes <strong>ggplot</strong> qui sont de plus en plus utilisés pour faire de la visualisation.</p>
<div id="fonctions-graphiques-conventionnelles" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Fonctions graphiques conventionnelles</h2>
<p>Pour commencer il est intéressant d’examiner quelques exemples de représentations graphiques construits avec <strong>R</strong>. On peut les obtenir à l’aide de la fonction <strong>demo</strong>.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="ggplot2.html#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">demo</span>(graphics)</span></code></pre></div>
<div id="la-fonction-plot" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> La fonction <strong>plot</strong></h3>
<p>C’est une <strong>fonction générique</strong> que l’on peut utiliser pour représenter différents types de données. L’utilisation standard consiste à visualiser une variable <em>y</em> en fonction d’une variable <em>x</em>. On peut par exemple obtenir le graphe de la fonction <span class="math inline">\(x\mapsto \sin(2\pi x)\)</span> sur <span class="math inline">\([0,1]\)</span>, à l’aide de</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="ggplot2.html#cb150-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>pi,<span class="dv">2</span><span class="sc">*</span>pi,<span class="at">by=</span><span class="fl">0.05</span>)</span>
<span id="cb150-2"><a href="ggplot2.html#cb150-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sin</span>(x)</span>
<span id="cb150-3"><a href="ggplot2.html#cb150-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y) <span class="co">#points (par défaut)</span></span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-259-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="ggplot2.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y,<span class="at">type=</span><span class="st">&quot;l&quot;</span>) <span class="co">#représentation sous forme de ligne</span></span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-259-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>Nous proposons des exemples de représentations de variables quantitatives et qualitatives à l’aide du jeu de données <strong>ozone.txt</strong> que l’on importe avec</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="ggplot2.html#cb152-1" aria-hidden="true" tabindex="-1"></a>ozone <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;data/ozone.txt&quot;</span>)</span>
<span id="cb152-2"><a href="ggplot2.html#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ozone)</span>
<span id="cb152-3"><a href="ggplot2.html#cb152-3" aria-hidden="true" tabindex="-1"></a>     maxO3              T9             T12       </span>
<span id="cb152-4"><a href="ggplot2.html#cb152-4" aria-hidden="true" tabindex="-1"></a> Min.   <span class="sc">:</span> <span class="fl">42.00</span>   Min.   <span class="sc">:</span><span class="fl">11.30</span>   Min.   <span class="sc">:</span><span class="fl">14.00</span>  </span>
<span id="cb152-5"><a href="ggplot2.html#cb152-5" aria-hidden="true" tabindex="-1"></a> 1st Qu.<span class="sc">:</span> <span class="fl">70.75</span>   1st Qu.<span class="sc">:</span><span class="fl">16.20</span>   1st Qu.<span class="sc">:</span><span class="fl">18.60</span>  </span>
<span id="cb152-6"><a href="ggplot2.html#cb152-6" aria-hidden="true" tabindex="-1"></a> Median <span class="sc">:</span> <span class="fl">81.50</span>   Median <span class="sc">:</span><span class="fl">17.80</span>   Median <span class="sc">:</span><span class="fl">20.55</span>  </span>
<span id="cb152-7"><a href="ggplot2.html#cb152-7" aria-hidden="true" tabindex="-1"></a> Mean   <span class="sc">:</span> <span class="fl">90.30</span>   Mean   <span class="sc">:</span><span class="fl">18.36</span>   Mean   <span class="sc">:</span><span class="fl">21.53</span>  </span>
<span id="cb152-8"><a href="ggplot2.html#cb152-8" aria-hidden="true" tabindex="-1"></a> 3rd Qu.<span class="sc">:</span><span class="fl">106.00</span>   3rd Qu.<span class="sc">:</span><span class="fl">19.93</span>   3rd Qu.<span class="sc">:</span><span class="fl">23.55</span>  </span>
<span id="cb152-9"><a href="ggplot2.html#cb152-9" aria-hidden="true" tabindex="-1"></a> Max.   <span class="sc">:</span><span class="fl">166.00</span>   Max.   <span class="sc">:</span><span class="fl">27.00</span>   Max.   <span class="sc">:</span><span class="fl">33.50</span>  </span>
<span id="cb152-10"><a href="ggplot2.html#cb152-10" aria-hidden="true" tabindex="-1"></a>      T15             Ne9             Ne12      </span>
<span id="cb152-11"><a href="ggplot2.html#cb152-11" aria-hidden="true" tabindex="-1"></a> Min.   <span class="sc">:</span><span class="fl">14.90</span>   Min.   <span class="sc">:</span><span class="fl">0.000</span>   Min.   <span class="sc">:</span><span class="fl">0.000</span>  </span>
<span id="cb152-12"><a href="ggplot2.html#cb152-12" aria-hidden="true" tabindex="-1"></a> 1st Qu.<span class="sc">:</span><span class="fl">19.27</span>   1st Qu.<span class="sc">:</span><span class="fl">3.000</span>   1st Qu.<span class="sc">:</span><span class="fl">4.000</span>  </span>
<span id="cb152-13"><a href="ggplot2.html#cb152-13" aria-hidden="true" tabindex="-1"></a> Median <span class="sc">:</span><span class="fl">22.05</span>   Median <span class="sc">:</span><span class="fl">6.000</span>   Median <span class="sc">:</span><span class="fl">5.000</span>  </span>
<span id="cb152-14"><a href="ggplot2.html#cb152-14" aria-hidden="true" tabindex="-1"></a> Mean   <span class="sc">:</span><span class="fl">22.63</span>   Mean   <span class="sc">:</span><span class="fl">4.929</span>   Mean   <span class="sc">:</span><span class="fl">5.018</span>  </span>
<span id="cb152-15"><a href="ggplot2.html#cb152-15" aria-hidden="true" tabindex="-1"></a> 3rd Qu.<span class="sc">:</span><span class="fl">25.40</span>   3rd Qu.<span class="sc">:</span><span class="fl">7.000</span>   3rd Qu.<span class="sc">:</span><span class="fl">7.000</span>  </span>
<span id="cb152-16"><a href="ggplot2.html#cb152-16" aria-hidden="true" tabindex="-1"></a> Max.   <span class="sc">:</span><span class="fl">35.50</span>   Max.   <span class="sc">:</span><span class="fl">8.000</span>   Max.   <span class="sc">:</span><span class="fl">8.000</span>  </span>
<span id="cb152-17"><a href="ggplot2.html#cb152-17" aria-hidden="true" tabindex="-1"></a>      Ne15           Vx9               Vx12       </span>
<span id="cb152-18"><a href="ggplot2.html#cb152-18" aria-hidden="true" tabindex="-1"></a> Min.   <span class="sc">:</span><span class="fl">0.00</span>   Min.   <span class="sc">:-</span><span class="fl">7.8785</span>   Min.   <span class="sc">:-</span><span class="fl">7.878</span>  </span>
<span id="cb152-19"><a href="ggplot2.html#cb152-19" aria-hidden="true" tabindex="-1"></a> 1st Qu.<span class="sc">:</span><span class="fl">3.00</span>   1st Qu.<span class="sc">:-</span><span class="fl">3.2765</span>   1st Qu.<span class="sc">:-</span><span class="fl">3.565</span>  </span>
<span id="cb152-20"><a href="ggplot2.html#cb152-20" aria-hidden="true" tabindex="-1"></a> Median <span class="sc">:</span><span class="fl">5.00</span>   Median <span class="sc">:-</span><span class="fl">0.8660</span>   Median <span class="sc">:-</span><span class="fl">1.879</span>  </span>
<span id="cb152-21"><a href="ggplot2.html#cb152-21" aria-hidden="true" tabindex="-1"></a> Mean   <span class="sc">:</span><span class="fl">4.83</span>   Mean   <span class="sc">:-</span><span class="fl">1.2143</span>   Mean   <span class="sc">:-</span><span class="fl">1.611</span>  </span>
<span id="cb152-22"><a href="ggplot2.html#cb152-22" aria-hidden="true" tabindex="-1"></a> 3rd Qu.<span class="sc">:</span><span class="fl">7.00</span>   3rd Qu.<span class="sc">:</span> <span class="fl">0.6946</span>   3rd Qu.<span class="sc">:</span> <span class="fl">0.000</span>  </span>
<span id="cb152-23"><a href="ggplot2.html#cb152-23" aria-hidden="true" tabindex="-1"></a> Max.   <span class="sc">:</span><span class="fl">8.00</span>   Max.   <span class="sc">:</span> <span class="fl">5.1962</span>   Max.   <span class="sc">:</span> <span class="fl">6.578</span>  </span>
<span id="cb152-24"><a href="ggplot2.html#cb152-24" aria-hidden="true" tabindex="-1"></a>      Vx15            maxO3v           vent          </span>
<span id="cb152-25"><a href="ggplot2.html#cb152-25" aria-hidden="true" tabindex="-1"></a> Min.   <span class="sc">:-</span><span class="fl">9.000</span>   Min.   <span class="sc">:</span> <span class="fl">42.00</span>   Length<span class="sc">:</span><span class="dv">112</span>        </span>
<span id="cb152-26"><a href="ggplot2.html#cb152-26" aria-hidden="true" tabindex="-1"></a> 1st Qu.<span class="sc">:-</span><span class="fl">3.939</span>   1st Qu.<span class="sc">:</span> <span class="fl">71.00</span>   Class <span class="sc">:</span>character  </span>
<span id="cb152-27"><a href="ggplot2.html#cb152-27" aria-hidden="true" tabindex="-1"></a> Median <span class="sc">:-</span><span class="fl">1.550</span>   Median <span class="sc">:</span> <span class="fl">82.50</span>   Mode  <span class="sc">:</span>character  </span>
<span id="cb152-28"><a href="ggplot2.html#cb152-28" aria-hidden="true" tabindex="-1"></a> Mean   <span class="sc">:-</span><span class="fl">1.691</span>   Mean   <span class="sc">:</span> <span class="fl">90.57</span>                     </span>
<span id="cb152-29"><a href="ggplot2.html#cb152-29" aria-hidden="true" tabindex="-1"></a> 3rd Qu.<span class="sc">:</span> <span class="fl">0.000</span>   3rd Qu.<span class="sc">:</span><span class="fl">106.00</span>                     </span>
<span id="cb152-30"><a href="ggplot2.html#cb152-30" aria-hidden="true" tabindex="-1"></a> Max.   <span class="sc">:</span> <span class="fl">5.000</span>   Max.   <span class="sc">:</span><span class="fl">166.00</span>                     </span>
<span id="cb152-31"><a href="ggplot2.html#cb152-31" aria-hidden="true" tabindex="-1"></a>    pluie          </span>
<span id="cb152-32"><a href="ggplot2.html#cb152-32" aria-hidden="true" tabindex="-1"></a> Length<span class="sc">:</span><span class="dv">112</span>        </span>
<span id="cb152-33"><a href="ggplot2.html#cb152-33" aria-hidden="true" tabindex="-1"></a> Class <span class="sc">:</span>character  </span>
<span id="cb152-34"><a href="ggplot2.html#cb152-34" aria-hidden="true" tabindex="-1"></a> Mode  <span class="sc">:</span>character  </span>
<span id="cb152-35"><a href="ggplot2.html#cb152-35" aria-hidden="true" tabindex="-1"></a>                   </span>
<span id="cb152-36"><a href="ggplot2.html#cb152-36" aria-hidden="true" tabindex="-1"></a>                   </span>
<span id="cb152-37"><a href="ggplot2.html#cb152-37" aria-hidden="true" tabindex="-1"></a>                   </span></code></pre></div>
<p>On visualise tout d’abord 2 variables quantitatives à l’aide d’un nuage de points : la concentration en ozone maximale <strong>maxO3</strong> en fonction de la température à 12h <strong>T12</strong>.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="ggplot2.html#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ozone[,<span class="st">&quot;T12&quot;</span>],ozone[,<span class="st">&quot;maxO3&quot;</span>])</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-261-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Comme les deux variables appartiennent au même jeu de données, on peut obtenir la même représentation à l’aide d’une sytaxe plus claire qui ajoute automatiquement les noms des variables sur les axes :</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="ggplot2.html#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(maxO3<span class="sc">~</span>T12,<span class="at">data=</span>ozone)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-262-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Une autre façon de faire (moins naturelle) :</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="ggplot2.html#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ozone[,<span class="st">&quot;T12&quot;</span>],ozone[,<span class="st">&quot;maxO3&quot;</span>],<span class="at">xlab=</span><span class="st">&quot;T12&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;maxO3&quot;</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-263-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Il existe des fonctions spécifiques pour chaque type de graphes, par exemple <strong>histogram</strong>, <strong>barplot</strong> et <strong>boxplot</strong> :</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="ggplot2.html#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ozone<span class="sc">$</span>maxO3,<span class="at">main=</span><span class="st">&quot;Histogram&quot;</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-264-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="ggplot2.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(ozone<span class="sc">$</span>vent)<span class="sc">/</span><span class="fu">nrow</span>(ozone),<span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-264-2.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="ggplot2.html#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(maxO3<span class="sc">~</span>vent,<span class="at">data=</span>ozone)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-264-3.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="graphes-interactifs-avec-ramcharts" class="section level3" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Graphes interactifs avec rAmCharts</h3>
<p>On peut utiliser ce package pour obtenir des graphes dynamiques. L’utilisation est relativement simple, il suffit d’ajouter le préfixe <strong>am</strong> devant le nom de la fonction :</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="ggplot2.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rAmCharts)</span>
<span id="cb159-2"><a href="ggplot2.html#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="fu">amHist</span>(ozone<span class="sc">$</span>maxO3)</span></code></pre></div>
<div id="htmlwidget-44438f284fe3e76efb5c" style="width:100%;height:500px;" class="ramcharts_base html-widget"></div>
<script type="application/json" data-for="htmlwidget-44438f284fe3e76efb5c">{"x":{"chartData":{"columnSpacing":0,"columnWidth":1,"fillAlphas":1,"lineAlpha":1,"categoryAxis":{"title":"ozone$maxO3"},"categoryField":"x","creditsPosition":"bottom-right","dataProvider":[{"x":50,"y":10,"cut":"(from 40 to 60)","color":"#1e90ff"},{"x":70,"y":43,"cut":"(from 60 to 80)","color":"#1e90ff"},{"x":90,"y":27,"cut":"(from 80 to 100)","color":"#1e90ff"},{"x":110,"y":16,"cut":"(from 100 to 120)","color":"#1e90ff"},{"x":130,"y":5,"cut":"(from 120 to 140)","color":"#1e90ff"},{"x":150,"y":10,"cut":"(from 140 to 160)","color":"#1e90ff"},{"x":170,"y":1,"cut":"(from 160 to 180)","color":"#1e90ff"}],"graphs":[{"animationPlayed":false,"fillAlphas":0.8,"lineAlpha":1,"fillColorsField":"color","lineColor":"#1e90ff","labelText":"","balloonText":"<b>[[value]]<\/b> <br/> [[cut]] ","type":"column","valueField":"y"}],"theme":"light","type":"serial","valueAxes":[{"minimum":0,"maximum":45.15,"title":"Frequency"}]},"background":"#ffffff","listeners":null,"axes_listeners":null,"axes_listenersIndices":null,"categoryAxis_listeners":null,"chartCursor_listeners":null,"dataSetSelector_listeners":null,"legend_listeners":null,"panels_listeners":null,"panels_listenersIndices":null,"periodSelector_listeners":null,"valueAxes_listeners":null,"valueAxes_listenersIndices":[],"stockLegend_listeners":null,"group":null,"is_ts_module":false},"evals":[],"jsHooks":[]}</script>
amPlot(ozone,col=c("T9","T12"))
<div id="htmlwidget-5f53fc31aea5db6e4a1e" style="width:100%;height:500px;" class="ramcharts_base html-widget"></div>
<script type="application/json" data-for="htmlwidget-5f53fc31aea5db6e4a1e">{"x":{"chartData":{"precision":2,"categoryAxis":{"title":"index","position":"bottom","id":"x"},"categoryField":"amCategory","dataProvider":[{"T9":15.6,"T12":18.5,"amCategory":"Obs. 1"},{"T9":17,"T12":18.4,"amCategory":"Obs. 2"},{"T9":15.3,"T12":17.6,"amCategory":"Obs. 3"},{"T9":16.2,"T12":19.7,"amCategory":"Obs. 4"},{"T9":17.4,"T12":20.5,"amCategory":"Obs. 5"},{"T9":17.7,"T12":19.8,"amCategory":"Obs. 6"},{"T9":16.8,"T12":15.6,"amCategory":"Obs. 7"},{"T9":14.9,"T12":17.5,"amCategory":"Obs. 8"},{"T9":16.1,"T12":19.6,"amCategory":"Obs. 9"},{"T9":18.3,"T12":21.9,"amCategory":"Obs. 10"},{"T9":17.3,"T12":19.3,"amCategory":"Obs. 11"},{"T9":17.6,"T12":20.3,"amCategory":"Obs. 12"},{"T9":18.3,"T12":19.6,"amCategory":"Obs. 13"},{"T9":17.1,"T12":18.2,"amCategory":"Obs. 14"},{"T9":15.4,"T12":17.4,"amCategory":"Obs. 15"},{"T9":15.9,"T12":19.1,"amCategory":"Obs. 16"},{"T9":21,"T12":24.6,"amCategory":"Obs. 17"},{"T9":16.2,"T12":22.4,"amCategory":"Obs. 18"},{"T9":19.7,"T12":24.2,"amCategory":"Obs. 19"},{"T9":23.6,"T12":28.6,"amCategory":"Obs. 20"},{"T9":20.4,"T12":25.2,"amCategory":"Obs. 21"},{"T9":27,"T12":32.7,"amCategory":"Obs. 22"},{"T9":24,"T12":23.5,"amCategory":"Obs. 23"},{"T9":19.7,"T12":22.9,"amCategory":"Obs. 24"},{"T9":20.1,"T12":22.4,"amCategory":"Obs. 25"},{"T9":19.6,"T12":25.1,"amCategory":"Obs. 26"},{"T9":19.5,"T12":23.4,"amCategory":"Obs. 27"},{"T9":18.8,"T12":22.7,"amCategory":"Obs. 28"},{"T9":24.1,"T12":28.4,"amCategory":"Obs. 29"},{"T9":26.6,"T12":30.1,"amCategory":"Obs. 30"},{"T9":19.5,"T12":18.8,"amCategory":"Obs. 31"},{"T9":16.8,"T12":18.2,"amCategory":"Obs. 32"},{"T9":20.8,"T12":23.7,"amCategory":"Obs. 33"},{"T9":17.5,"T12":18.2,"amCategory":"Obs. 34"},{"T9":18.1,"T12":21.2,"amCategory":"Obs. 35"},{"T9":19.2,"T12":22,"amCategory":"Obs. 36"},{"T9":19.4,"T12":20.7,"amCategory":"Obs. 37"},{"T9":19.2,"T12":21,"amCategory":"Obs. 38"},{"T9":13.8,"T12":17.3,"amCategory":"Obs. 39"},{"T9":14.3,"T12":14.5,"amCategory":"Obs. 40"},{"T9":15.6,"T12":18.6,"amCategory":"Obs. 41"},{"T9":16.9,"T12":19.1,"amCategory":"Obs. 42"},{"T9":17.4,"T12":20.4,"amCategory":"Obs. 43"},{"T9":15.1,"T12":20.5,"amCategory":"Obs. 44"},{"T9":15.1,"T12":15.6,"amCategory":"Obs. 45"},{"T9":16.7,"T12":19.1,"amCategory":"Obs. 46"},{"T9":16.9,"T12":20.3,"amCategory":"Obs. 47"},{"T9":18,"T12":21.6,"amCategory":"Obs. 48"},{"T9":18.6,"T12":21.9,"amCategory":"Obs. 49"},{"T9":18.8,"T12":22.5,"amCategory":"Obs. 50"},{"T9":19,"T12":22.5,"amCategory":"Obs. 51"},{"T9":19.9,"T12":26.9,"amCategory":"Obs. 52"},{"T9":23.8,"T12":27.7,"amCategory":"Obs. 53"},{"T9":24,"T12":28.3,"amCategory":"Obs. 54"},{"T9":23.3,"T12":27.6,"amCategory":"Obs. 55"},{"T9":25,"T12":29.6,"amCategory":"Obs. 56"},{"T9":24.9,"T12":30.5,"amCategory":"Obs. 57"},{"T9":20.5,"T12":26.3,"amCategory":"Obs. 58"},{"T9":25.3,"T12":29.5,"amCategory":"Obs. 59"},{"T9":21.3,"T12":23.8,"amCategory":"Obs. 60"},{"T9":20,"T12":18.2,"amCategory":"Obs. 61"},{"T9":18.7,"T12":20.6,"amCategory":"Obs. 62"},{"T9":18.6,"T12":18.7,"amCategory":"Obs. 63"},{"T9":19.2,"T12":23,"amCategory":"Obs. 64"},{"T9":19.9,"T12":21.6,"amCategory":"Obs. 65"},{"T9":18.7,"T12":21.4,"amCategory":"Obs. 66"},{"T9":18.4,"T12":17.1,"amCategory":"Obs. 67"},{"T9":17.1,"T12":20,"amCategory":"Obs. 68"},{"T9":17.8,"T12":22.8,"amCategory":"Obs. 69"},{"T9":20.9,"T12":25.2,"amCategory":"Obs. 70"},{"T9":18.8,"T12":20.5,"amCategory":"Obs. 71"},{"T9":23.5,"T12":29.8,"amCategory":"Obs. 72"},{"T9":20.8,"T12":23.7,"amCategory":"Obs. 73"},{"T9":18.8,"T12":21.1,"amCategory":"Obs. 74"},{"T9":17.8,"T12":21.3,"amCategory":"Obs. 75"},{"T9":20.6,"T12":24.8,"amCategory":"Obs. 76"},{"T9":21.6,"T12":26.9,"amCategory":"Obs. 77"},{"T9":22.7,"T12":28.4,"amCategory":"Obs. 78"},{"T9":19.8,"T12":27.2,"amCategory":"Obs. 79"},{"T9":25,"T12":33.5,"amCategory":"Obs. 80"},{"T9":20.1,"T12":22.9,"amCategory":"Obs. 81"},{"T9":21,"T12":26.3,"amCategory":"Obs. 82"},{"T9":21,"T12":24.4,"amCategory":"Obs. 83"},{"T9":16.9,"T12":17.8,"amCategory":"Obs. 84"},{"T9":17.5,"T12":18.6,"amCategory":"Obs. 85"},{"T9":16.5,"T12":20.3,"amCategory":"Obs. 86"},{"T9":17.7,"T12":20.2,"amCategory":"Obs. 87"},{"T9":17.3,"T12":22.7,"amCategory":"Obs. 88"},{"T9":15.3,"T12":16.8,"amCategory":"Obs. 89"},{"T9":15.9,"T12":19.2,"amCategory":"Obs. 90"},{"T9":16.2,"T12":18.9,"amCategory":"Obs. 91"},{"T9":18.3,"T12":18.3,"amCategory":"Obs. 92"},{"T9":16.9,"T12":20.8,"amCategory":"Obs. 93"},{"T9":17.3,"T12":19.8,"amCategory":"Obs. 94"},{"T9":14.2,"T12":22.2,"amCategory":"Obs. 95"},{"T9":15.8,"T12":18.7,"amCategory":"Obs. 96"},{"T9":15.2,"T12":17.9,"amCategory":"Obs. 97"},{"T9":17.1,"T12":17.7,"amCategory":"Obs. 98"},{"T9":15.4,"T12":17.7,"amCategory":"Obs. 99"},{"T9":13.7,"T12":14,"amCategory":"Obs. 100"},{"T9":12.7,"T12":14.3,"amCategory":"Obs. 101"},{"T9":14.8,"T12":16.3,"amCategory":"Obs. 102"},{"T9":15.5,"T12":18,"amCategory":"Obs. 103"},{"T9":11.3,"T12":19.4,"amCategory":"Obs. 104"},{"T9":15.2,"T12":19.7,"amCategory":"Obs. 105"},{"T9":14.7,"T12":17.6,"amCategory":"Obs. 106"},{"T9":13.3,"T12":17.7,"amCategory":"Obs. 107"},{"T9":13.3,"T12":17.7,"amCategory":"Obs. 108"},{"T9":16.2,"T12":20.8,"amCategory":"Obs. 109"},{"T9":16.9,"T12":23,"amCategory":"Obs. 110"},{"T9":16.9,"T12":19.8,"amCategory":"Obs. 111"},{"T9":15.7,"T12":18.6,"amCategory":"Obs. 112"}],"graphs":[{"animationPlayed":false,"lineAlpha":1,"bullet":"round","fill_alphas":0,"bulletAlpha":0,"maxBulletSize":0,"balloonText":"value: <b>[[value]]<\/b>","title":"T9","type":"line","valueField":"T9"},{"animationPlayed":false,"lineAlpha":1,"bullet":"round","fill_alphas":0,"bulletAlpha":0,"maxBulletSize":0,"balloonText":"value: <b>[[value]]<\/b>","title":"T12","type":"line","valueField":"T12"}],"type":"serial","valueAxes":[{"position":"left","id":"y","title":"ozone"}]},"background":"#ffffff","listeners":null,"axes_listeners":null,"axes_listenersIndices":null,"categoryAxis_listeners":null,"chartCursor_listeners":null,"dataSetSelector_listeners":null,"legend_listeners":null,"panels_listeners":null,"panels_listenersIndices":null,"periodSelector_listeners":null,"valueAxes_listeners":null,"valueAxes_listenersIndices":[],"stockLegend_listeners":null,"group":null,"is_ts_module":false},"evals":[],"jsHooks":[]}</script>
amBoxplot(maxO3~vent,data=ozone)
<div id="htmlwidget-47db5c59ee960207bc38" style="width:100%;height:500px;" class="ramcharts_base html-widget"></div>
<script type="application/json" data-for="htmlwidget-47db5c59ee960207bc38">{"x":{"chartData":{"rotate":false,"categoryField":"cat","dataProvider":[{"cat":"Est","low_outlier":92,"low":92,"open":96,"median":109,"close":121,"high":146,"high_outlier":146,"color":"#1e90ff","real_outlier_1":"45","individual_1":"<b> Individual <\/b>: 40"},{"cat":"Nord","low_outlier":42,"low":42,"open":71,"median":81,"close":94.5,"high":121,"high_outlier":121,"color":"#1e90ff","real_outlier_1":"153","individual_1":"<b> Individual <\/b>: 53","real_outlier_2":"159","individual_2":"<b> Individual <\/b>: 54"},{"cat":"Ouest","low_outlier":55,"low":55,"open":67,"median":76,"close":88,"high":113,"high_outlier":113,"color":"#1e90ff","real_outlier_1":"131","individual_1":"<b> Individual <\/b>: 78","real_outlier_2":"145","individual_2":"<b> Individual <\/b>: 17","real_outlier_3":"149","individual_3":"<b> Number of outliers <\/b>: 2","real_outlier_4":"156","individual_4":"<b> Individual <\/b>: 57","real_outlier_5":"166","individual_5":"<b> Individual <\/b>: 79"},{"cat":"Sud","low_outlier":54,"low":54,"open":81,"median":99,"close":116,"high":160,"high_outlier":160,"color":"#1e90ff"}],"graphs":[{"animationPlayed":false,"id":"g1","closeField":"close","fillColorsField":"color","highField":"high","lineColor":"#7f8da9","lineAlpha":1,"lowField":"low","fillAlphas":"0.9","negativeLineColor":"#7f8da9","openField":"open","columnWidth":0.4,"balloonText":"High = <b>[[high_outlier]]<\/b><br/>3rd quart. = <b>[[close]]<\/b><br/>Median = <b>[[median]]<\/b><br/>1st quart. = <b>[[open]]<\/b><br/>Low = <b>[[low_outlier]]<\/b><br/>","title":"Price:","type":"candlestick","valueField":"close"},{"animationPlayed":false,"id":"g2","lineColor":"black","noStepRisers":true,"lineThickness":3,"periodSpan":0.4,"balloonText":"","type":"step","valueField":"median"},{"animationPlayed":false,"id":"g3","lineColor":"black","noStepRisers":true,"periodSpan":0.3,"balloonText":"","type":"step","valueField":"low_outlier"},{"animationPlayed":false,"id":"g4","lineColor":"black","noStepRisers":true,"periodSpan":0.3,"balloonText":"","type":"step","valueField":"high_outlier"},{"animationPlayed":false,"id":"g5","lineColor":"black","lineAlpha":0,"bullet":"round","noStepRisers":true,"periodSpan":0.5,"balloonText":"","type":"line","valueField":"real_outlier"},{"animationPlayed":false,"lineColor":"black","lineAlpha":0,"bullet":"round","noStepRisers":true,"periodSpan":0.5,"balloonText":"[[individual_1]]<br/><b> Value <\/b>: [[real_outlier_1]]","type":"line","valueField":"real_outlier_1"},{"animationPlayed":false,"lineColor":"black","lineAlpha":0,"bullet":"round","noStepRisers":true,"periodSpan":0.5,"balloonText":"[[individual_2]]<br/><b> Value <\/b>: [[real_outlier_2]]","type":"line","valueField":"real_outlier_2"},{"animationPlayed":false,"lineColor":"black","lineAlpha":0,"bullet":"round","noStepRisers":true,"periodSpan":0.5,"balloonText":"[[individual_3]]<br/><b> Value <\/b>: [[real_outlier_3]]","type":"line","valueField":"real_outlier_3"},{"animationPlayed":false,"lineColor":"black","lineAlpha":0,"bullet":"round","noStepRisers":true,"periodSpan":0.5,"balloonText":"[[individual_4]]<br/><b> Value <\/b>: [[real_outlier_4]]","type":"line","valueField":"real_outlier_4"},{"animationPlayed":false,"lineColor":"black","lineAlpha":0,"bullet":"round","noStepRisers":true,"periodSpan":0.5,"balloonText":"[[individual_5]]<br/><b> Value <\/b>: [[real_outlier_5]]","type":"line","valueField":"real_outlier_5"},{"animationPlayed":false,"lineColor":"black","lineAlpha":0,"bullet":"round","noStepRisers":true,"periodSpan":0.5,"balloonText":"[[individual_6]]<br/><b> Value <\/b>: [[real_outlier_6]]","type":"line","valueField":"real_outlier_6"},{"animationPlayed":false,"lineColor":"black","lineAlpha":0,"bullet":"round","noStepRisers":true,"periodSpan":0.5,"balloonText":"[[individual_7]]<br/><b> Value <\/b>: [[real_outlier_7]]","type":"line","valueField":"real_outlier_7"},{"animationPlayed":false,"lineColor":"black","lineAlpha":0,"bullet":"round","noStepRisers":true,"periodSpan":0.5,"balloonText":"[[individual_8]]<br/><b> Value <\/b>: [[real_outlier_8]]","type":"line","valueField":"real_outlier_8"},{"animationPlayed":false,"lineColor":"black","lineAlpha":0,"bullet":"round","noStepRisers":true,"periodSpan":0.5,"balloonText":"[[individual_9]]<br/><b> Value <\/b>: [[real_outlier_9]]","type":"line","valueField":"real_outlier_9"},{"animationPlayed":false,"lineColor":"black","lineAlpha":0,"bullet":"round","noStepRisers":true,"periodSpan":0.5,"balloonText":"[[individual_10]]<br/><b> Value <\/b>: [[real_outlier_10]]","type":"line","valueField":"real_outlier_10"},{"animationPlayed":false,"lineColor":"black","lineAlpha":0,"bullet":"round","noStepRisers":true,"periodSpan":0.5,"balloonText":"[[individual_11]]<br/><b> Value <\/b>: [[real_outlier_11]]","type":"line","valueField":"real_outlier_11"}],"theme":"light","type":"serial"},"background":"#ffffff","listeners":null,"axes_listeners":null,"axes_listenersIndices":null,"categoryAxis_listeners":null,"chartCursor_listeners":null,"dataSetSelector_listeners":null,"legend_listeners":null,"panels_listeners":null,"panels_listenersIndices":null,"periodSelector_listeners":null,"valueAxes_listeners":null,"valueAxes_listenersIndices":null,"stockLegend_listeners":null,"group":null,"is_ts_module":false},"evals":[],"jsHooks":[]}</script>
</div>
<div id="quelques-exercices-1" class="section level3" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Quelques exercices</h3>
<div class="exercise">
<p><span id="exr:exo1" class="exercise"><strong>Exercice 4.1  (Premier graphe) </strong></span>On s’intéresse à quelques graphes simples.</p>
<ol style="list-style-type: decimal">
<li><p>Tracer la fonction <strong>sinus</strong> entre <span class="math inline">\(0\)</span> et <span class="math inline">\(2\pi\)</span>.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="ggplot2.html#cb160-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">2</span><span class="sc">*</span>pi,<span class="at">length=</span><span class="dv">1000</span>)</span>
<span id="cb160-2"><a href="ggplot2.html#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="fu">sin</span>(x),<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-266-1.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p>A l’aide de la fonction <strong>title</strong> ajouter le titre <strong>Représentation de la fonction sinus</strong>.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="ggplot2.html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">&quot;Représentation de la fonction sinus&quot;</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-268-1.png" width="672" style="display: block; margin: auto;" /></p></li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:exo2" class="exercise"><strong>Exercice 4.2  (Tracé de densités) </strong></span>On souhaite ici visualiser et comparer des densités de probabilité.</p>
<ol style="list-style-type: decimal">
<li><p>Tracer la densité de la loi normale centrée réduite entre <span class="math inline">\(-4\)</span> et 4 (utiliser <strong>dnorm</strong>).</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="ggplot2.html#cb162-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>,<span class="at">by=</span><span class="fl">0.01</span>)</span>
<span id="cb162-2"><a href="ggplot2.html#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="fu">dnorm</span>(x),<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-269-1.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p>Ajouter une ligne verticale (en tirets) qui passe par <span class="math inline">\(x=0\)</span> (utiliser <strong>abline</strong> avec <strong>lty=2</strong>).</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="ggplot2.html#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-271-1.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p>Sur le même graphe, ajouter les densités de loi la de Student à 5 et 30 degrés de liberté (utiliser <strong>dt</strong>). On utilisera la fonction <strong>lines</strong> et des couleurs différentes pour chaque densité.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="ggplot2.html#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,<span class="fu">dt</span>(x,<span class="dv">5</span>),<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb164-2"><a href="ggplot2.html#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,<span class="fu">dt</span>(x,<span class="dv">30</span>),<span class="at">col=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-273-1.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p>Ajouter une légende qui permet de repérer chaque densité (fonction <strong>legend</strong>).</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="ggplot2.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Normal&quot;</span>,<span class="st">&quot;Student(5)&quot;</span>,<span class="st">&quot;Student(30)&quot;</span>),</span>
<span id="cb165-2"><a href="ggplot2.html#cb165-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="at">lty=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-275-1.png" width="672" style="display: block; margin: auto;" /></p></li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:exo3" class="exercise"><strong>Exercice 4.3  (Tâches solaires) </strong></span>On souhaite ici visualiser une série.</p>
<ol style="list-style-type: decimal">
<li><p>Importer la série <strong>taches_solaires.csv</strong> qui donne, date par date, un nombre de taches solaires observées.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="ggplot2.html#cb166-1" aria-hidden="true" tabindex="-1"></a>taches <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;data/taches_solaires.csv&quot;</span>,<span class="at">sep=</span><span class="st">&quot;;&quot;</span>,<span class="at">header=</span><span class="cn">TRUE</span>,<span class="at">dec=</span><span class="st">&quot;,&quot;</span>)</span></code></pre></div></li>
<li><p>A l’aide de la fonction <strong>cut_interval</strong> du <em>tidyverse</em> créer un facteur qui sépare l’intervalle d’années d’observation en 8 intervalles de tailles à peu près égales. On appellera <strong>periode</strong> ce facteur.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="ggplot2.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb167-2"><a href="ggplot2.html#cb167-2" aria-hidden="true" tabindex="-1"></a>periode <span class="ot">&lt;-</span> <span class="fu">cut_interval</span>(taches<span class="sc">$</span>annee,<span class="at">n=</span><span class="dv">8</span>)</span></code></pre></div></li>
<li><p>Utiliser les levels suivants pour le facteur <strong>periode</strong>.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="ggplot2.html#cb168-1" aria-hidden="true" tabindex="-1"></a>couleurs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;magenta&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;cyan&quot;</span>,</span>
<span id="cb168-2"><a href="ggplot2.html#cb168-2" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;grey&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="ggplot2.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(periode) <span class="ot">&lt;-</span> couleurs</span></code></pre></div></li>
<li><p>Expliquer la sortie de la fonction</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="ggplot2.html#cb170-1" aria-hidden="true" tabindex="-1"></a>coordx <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">along=</span>taches[,<span class="dv">1</span>])</span></code></pre></div>
<div class="corR">
<p>
On crée une séquence avec un pas de 1 de longueur égale à la dimension de <code>taches[,1]</code>.
</p>
</div></li>
<li><p>Visualiser la série du nombre de taches en utilisant une couleur différente pour chaque période.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="ggplot2.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(coordx,taches[,<span class="dv">1</span>],<span class="at">xlab=</span><span class="st">&quot;Temps&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Nombre de taches&quot;</span>,</span>
<span id="cb171-2"><a href="ggplot2.html#cb171-2" aria-hidden="true" tabindex="-1"></a> <span class="at">col=</span>periode,<span class="at">type=</span><span class="st">&quot;p&quot;</span>,<span class="at">pch=</span><span class="st">&quot;+&quot;</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-282-1.png" width="672" style="display: block; margin: auto;" /></p></li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:exo4" class="exercise"><strong>Exercice 4.4  (Layout) </strong></span>On reprend le jeu de données sur l’ozone. A l’aide de la fonction <strong>layout</strong> séparer la fenêtre graphique en deux lignes avec</p>
<ul>
<li><p>un graphe sur la première ligne (nuage de points <strong>maxO3 vs T12</strong>)</p></li>
<li><p>2 graphes sur la deuxième ligne (histogramme de <strong>T12</strong> et boxplot de <strong>maxO3</strong>).</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="ggplot2.html#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="dv">2</span>, <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb172-2"><a href="ggplot2.html#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(maxO3<span class="sc">~</span>T12,<span class="at">data=</span>ozone)</span>
<span id="cb172-3"><a href="ggplot2.html#cb172-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ozone<span class="sc">$</span>T12)</span>
<span id="cb172-4"><a href="ggplot2.html#cb172-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(ozone<span class="sc">$</span>maxO3)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-283-1.png" width="672" style="display: block; margin: auto;" /></p></li>
</ul>
</div>
</div>
</div>
<div id="la-grammaire-ggplot2" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> La grammaire <strong>ggplot2</strong></h2>
<p>Ce package propose de définir des graphes sur <strong>R</strong> en utilisant une <strong>grammaire des graphiques</strong> (tout comme <strong>dplyr</strong> pour manipuler les données). On peut trouver de la documentation sur ce package aux url <a href="http://ggplot2.org">http://ggplot2.org</a> et <a href="https://ggplot2-book.org">https://ggplot2-book.org</a>.</p>
<div id="premiers-graphes-ggplot2" class="section level3" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Premiers graphes <code>ggplot2</code></h3>
<p>Nous considérons un sous échantillon du jeu de données <strong>diamonds</strong> du package <strong>ggplot2</strong> (qui se trouve dans le <strong>tidyverse</strong>).</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="ggplot2.html#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb173-2"><a href="ggplot2.html#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb173-3"><a href="ggplot2.html#cb173-3" aria-hidden="true" tabindex="-1"></a>diamonds2 <span class="ot">&lt;-</span> diamonds[<span class="fu">sample</span>(<span class="fu">nrow</span>(diamonds),<span class="dv">5000</span>),] </span>
<span id="cb173-4"><a href="ggplot2.html#cb173-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(diamonds2)</span>
<span id="cb173-5"><a href="ggplot2.html#cb173-5" aria-hidden="true" tabindex="-1"></a>     carat               cut       color       clarity    </span>
<span id="cb173-6"><a href="ggplot2.html#cb173-6" aria-hidden="true" tabindex="-1"></a> Min.   <span class="sc">:</span><span class="fl">0.2000</span>   Fair     <span class="sc">:</span> <span class="dv">158</span>   D<span class="sc">:</span> <span class="dv">640</span>   SI1    <span class="sc">:</span><span class="dv">1189</span>  </span>
<span id="cb173-7"><a href="ggplot2.html#cb173-7" aria-hidden="true" tabindex="-1"></a> 1st Qu.<span class="sc">:</span><span class="fl">0.4000</span>   Good     <span class="sc">:</span> <span class="dv">455</span>   E<span class="sc">:</span> <span class="dv">916</span>   VS2    <span class="sc">:</span><span class="dv">1157</span>  </span>
<span id="cb173-8"><a href="ggplot2.html#cb173-8" aria-hidden="true" tabindex="-1"></a> Median <span class="sc">:</span><span class="fl">0.7000</span>   Very Good<span class="sc">:</span><span class="dv">1094</span>   F<span class="sc">:</span> <span class="dv">900</span>   SI2    <span class="sc">:</span> <span class="dv">876</span>  </span>
<span id="cb173-9"><a href="ggplot2.html#cb173-9" aria-hidden="true" tabindex="-1"></a> Mean   <span class="sc">:</span><span class="fl">0.7969</span>   Premium  <span class="sc">:</span><span class="dv">1280</span>   G<span class="sc">:</span><span class="dv">1018</span>   VS1    <span class="sc">:</span> <span class="dv">738</span>  </span>
<span id="cb173-10"><a href="ggplot2.html#cb173-10" aria-hidden="true" tabindex="-1"></a> 3rd Qu.<span class="sc">:</span><span class="fl">1.0400</span>   Ideal    <span class="sc">:</span><span class="dv">2013</span>   H<span class="sc">:</span> <span class="dv">775</span>   VVS2   <span class="sc">:</span> <span class="dv">470</span>  </span>
<span id="cb173-11"><a href="ggplot2.html#cb173-11" aria-hidden="true" tabindex="-1"></a> Max.   <span class="sc">:</span><span class="fl">4.1300</span>                    I<span class="sc">:</span> <span class="dv">481</span>   VVS1   <span class="sc">:</span> <span class="dv">326</span>  </span>
<span id="cb173-12"><a href="ggplot2.html#cb173-12" aria-hidden="true" tabindex="-1"></a>                                   J<span class="sc">:</span> <span class="dv">270</span>   (Other)<span class="sc">:</span> <span class="dv">244</span>  </span>
<span id="cb173-13"><a href="ggplot2.html#cb173-13" aria-hidden="true" tabindex="-1"></a>     depth           table           price      </span>
<span id="cb173-14"><a href="ggplot2.html#cb173-14" aria-hidden="true" tabindex="-1"></a> Min.   <span class="sc">:</span><span class="fl">43.00</span>   Min.   <span class="sc">:</span><span class="fl">49.00</span>   Min.   <span class="sc">:</span>  <span class="dv">365</span>  </span>
<span id="cb173-15"><a href="ggplot2.html#cb173-15" aria-hidden="true" tabindex="-1"></a> 1st Qu.<span class="sc">:</span><span class="fl">61.10</span>   1st Qu.<span class="sc">:</span><span class="fl">56.00</span>   1st Qu.<span class="sc">:</span>  <span class="dv">945</span>  </span>
<span id="cb173-16"><a href="ggplot2.html#cb173-16" aria-hidden="true" tabindex="-1"></a> Median <span class="sc">:</span><span class="fl">61.80</span>   Median <span class="sc">:</span><span class="fl">57.00</span>   Median <span class="sc">:</span> <span class="dv">2376</span>  </span>
<span id="cb173-17"><a href="ggplot2.html#cb173-17" aria-hidden="true" tabindex="-1"></a> Mean   <span class="sc">:</span><span class="fl">61.76</span>   Mean   <span class="sc">:</span><span class="fl">57.43</span>   Mean   <span class="sc">:</span> <span class="dv">3917</span>  </span>
<span id="cb173-18"><a href="ggplot2.html#cb173-18" aria-hidden="true" tabindex="-1"></a> 3rd Qu.<span class="sc">:</span><span class="fl">62.50</span>   3rd Qu.<span class="sc">:</span><span class="fl">59.00</span>   3rd Qu.<span class="sc">:</span> <span class="dv">5294</span>  </span>
<span id="cb173-19"><a href="ggplot2.html#cb173-19" aria-hidden="true" tabindex="-1"></a> Max.   <span class="sc">:</span><span class="fl">71.60</span>   Max.   <span class="sc">:</span><span class="fl">95.00</span>   Max.   <span class="sc">:</span><span class="dv">18757</span>  </span>
<span id="cb173-20"><a href="ggplot2.html#cb173-20" aria-hidden="true" tabindex="-1"></a>                                                </span>
<span id="cb173-21"><a href="ggplot2.html#cb173-21" aria-hidden="true" tabindex="-1"></a>       x                y               z        </span>
<span id="cb173-22"><a href="ggplot2.html#cb173-22" aria-hidden="true" tabindex="-1"></a> Min.   <span class="sc">:</span> <span class="fl">0.000</span>   Min.   <span class="sc">:</span><span class="fl">3.720</span>   Min.   <span class="sc">:</span><span class="fl">0.000</span>  </span>
<span id="cb173-23"><a href="ggplot2.html#cb173-23" aria-hidden="true" tabindex="-1"></a> 1st Qu.<span class="sc">:</span> <span class="fl">4.720</span>   1st Qu.<span class="sc">:</span><span class="fl">4.720</span>   1st Qu.<span class="sc">:</span><span class="fl">2.920</span>  </span>
<span id="cb173-24"><a href="ggplot2.html#cb173-24" aria-hidden="true" tabindex="-1"></a> Median <span class="sc">:</span> <span class="fl">5.690</span>   Median <span class="sc">:</span><span class="fl">5.700</span>   Median <span class="sc">:</span><span class="fl">3.520</span>  </span>
<span id="cb173-25"><a href="ggplot2.html#cb173-25" aria-hidden="true" tabindex="-1"></a> Mean   <span class="sc">:</span> <span class="fl">5.728</span>   Mean   <span class="sc">:</span><span class="fl">5.731</span>   Mean   <span class="sc">:</span><span class="fl">3.538</span>  </span>
<span id="cb173-26"><a href="ggplot2.html#cb173-26" aria-hidden="true" tabindex="-1"></a> 3rd Qu.<span class="sc">:</span> <span class="fl">6.530</span>   3rd Qu.<span class="sc">:</span><span class="fl">6.520</span>   3rd Qu.<span class="sc">:</span><span class="fl">4.030</span>  </span>
<span id="cb173-27"><a href="ggplot2.html#cb173-27" aria-hidden="true" tabindex="-1"></a> Max.   <span class="sc">:</span><span class="fl">10.000</span>   Max.   <span class="sc">:</span><span class="fl">9.850</span>   Max.   <span class="sc">:</span><span class="fl">6.430</span>  </span>
<span id="cb173-28"><a href="ggplot2.html#cb173-28" aria-hidden="true" tabindex="-1"></a>                                                 </span>
<span id="cb173-29"><a href="ggplot2.html#cb173-29" aria-hidden="true" tabindex="-1"></a><span class="fu">help</span>(diamonds)</span></code></pre></div>
<p>Pour un jeu de données considéré, un graphe <strong>ggplot</strong> est défini à partir de <strong>couches</strong> que l’on assemblera avec l’opérateur <code>+</code>. Il faut a minima spécifier :</p>
<ul>
<li>les données</li>
<li>les variables que l’on souhaite représenter</li>
<li>le type de représentation (nuage de points, boxplot…).</li>
</ul>
<p>Il existe un verbe pour définir chacune de ces couches :</p>
<ul>
<li><strong>ggplot</strong> pour les données</li>
<li><strong>aes</strong> (aesthetics) pour les variables</li>
<li><strong>geom_</strong> pour le type de représentation.</li>
</ul>
<p>On peut obtenir le nuage de points <strong>carat vs price</strong> avec la fonction <strong>plot</strong> :</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="ggplot2.html#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(price<span class="sc">~</span>carat,<span class="at">data=</span>diamonds2)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-285-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Avec <strong>ggplot</strong>, on va faire</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="ggplot2.html#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2) <span class="co">#rien</span></span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-286-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="ggplot2.html#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price) <span class="co">#rien</span></span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-286-2.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="ggplot2.html#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price)<span class="sc">+</span><span class="fu">geom_point</span>() <span class="co">#bon</span></span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-286-3.png" width="672" style="display: block; margin: auto;" /></p>
<div class="exercise">
<p><span id="exr:exoggplot1" class="exercise"><strong>Exercice 4.5  (Premiers graphes ggplot) </strong></span>L’objectif est de se familiariser avec la syntaxe <code>ggplot</code>.</p>
<ol style="list-style-type: decimal">
<li><p>Tracer l’histogramme de la variable <strong>carat</strong> (utiliser <code>geom_histogram</code>).</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="ggplot2.html#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat)<span class="sc">+</span><span class="fu">geom_histogram</span>()</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-287-1.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p>Tracer l’histogramme de la variable <strong>carat</strong> avec 10 classes (<strong>help(geom_histogram)</strong>).</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="ggplot2.html#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat)<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">10</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-288-1.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p>Tracer le diagramme en barres de la variable <strong>cut</strong> (utiliser <strong>geom_bar</strong>).</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="ggplot2.html#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>cut)<span class="sc">+</span><span class="fu">geom_bar</span>()</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-289-1.png" width="672" style="display: block; margin: auto;" /></p></li>
</ol>
</div>
<p>La syntaxe <strong>ggplot</strong> se construit à partir d’éléments indépendants qui définissent la grammaire de <strong>ggplot</strong>. Les principaux verbes sont :</p>
<ul>
<li><strong>Data</strong> (<code>ggplot</code>) : les données au format <strong>dataframe</strong> ou <strong>tibble</strong></li>
<li><strong>Aesthetics</strong> (<code>aes</code>) : pour sépecifier les variables à représenter dans le graphe.</li>
<li><strong>Geometrics</strong> (<code>geom_...</code>) : le type de graphe (nuage de points, histogramme…).</li>
<li><strong>Statistics</strong> (<code>stat_...</code>) : utile pour spécifier des transformations des données nécessaires pour obtenir le graphe.</li>
<li><strong>Scales</strong> (<code>scale_...</code>) : pour controler les paramètres permettant d’affiner le graphe (changement de couleurs, paramètres des axes…).</li>
</ul>
<p>Tous ces éléments sont reliés avec le symbole <strong>+</strong>.</p>
</div>
<div id="data-et-aesthetics" class="section level3" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Data et aesthetics</h3>
<p>Ces deux verbes sont à utiliser pour tous les graphes <strong>ggplot</strong>. Le verbe <code>ggplot</code> servira à définir le jeu de données que l’on souhaite utiliser. Si le code est bien fait, nous n’aurons plus à utiliser le nom du jeu de données par la suite pour construire le graphe. Le verbe <code>aes</code> est quant à lui utile pour spécifier le nom des variables que l’on souhaite visualiser. Par exemple, pour le nuage de points <strong>price vs carat</strong> la syntaxe devra débuter par</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="ggplot2.html#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price)</span></code></pre></div>
<p>Les variables peuvent également être utilisées pour colorier des points ou des barres, définir des tailles… Dans ce cas on pourra renseigner les arguments <strong>color</strong>, <strong>size</strong>, <strong>fill</strong> dans la fonction <strong>aes</strong>. Par exemple</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="ggplot2.html#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price,<span class="at">color=</span>cut)</span></code></pre></div>
</div>
<div id="geometrics" class="section level3" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Geometrics</h3>
<p>Ce verbe décrira le type de représentation souhaité. Pour un nuage de points, on utilisera par exemple <strong>geom_point</strong> :</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="ggplot2.html#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price,<span class="at">color=</span>cut)<span class="sc">+</span><span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-292-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>On observe que <strong>ggplot</strong> ajoute la légende automatiquement. Voici les principaux exemples de <strong>geometrics</strong> :</p>
<table>
<caption><span id="tab:geom">Table 4.1: </span> Principaux geometrics</caption>
<thead>
<tr class="header">
<th>Geom</th>
<th>Description</th>
<th>Aesthetics</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>geom_point()</td>
<td>nuage de points</td>
<td>x, y, shape, fill</td>
</tr>
<tr class="even">
<td>geom_line()</td>
<td>Ligne (ordonnée selon x)</td>
<td>x, y, linetype</td>
</tr>
<tr class="odd">
<td>geom_abline()</td>
<td>Ligne</td>
<td>slope, intercept</td>
</tr>
<tr class="even">
<td>geom_path()</td>
<td>Ligne (ordonnée par l’index)</td>
<td>x, y, linetype</td>
</tr>
<tr class="odd">
<td>geom_text()</td>
<td>Texte</td>
<td>x, y, label, hjust, vjust</td>
</tr>
<tr class="even">
<td>geom_rect()</td>
<td>Rectangle</td>
<td>xmin, xmax, ymin, ymax, fill, linetype</td>
</tr>
<tr class="odd">
<td>geom_polygon()</td>
<td>Polygone</td>
<td>x, y, fill, linetype</td>
</tr>
<tr class="even">
<td>geom_segment()</td>
<td>Segment</td>
<td>x, y, xend, yend, fill, linetype</td>
</tr>
<tr class="odd">
<td>geom_bar()</td>
<td>Diagramme en barres</td>
<td>x, fill, linetype, weight</td>
</tr>
<tr class="even">
<td>geom_histogram()</td>
<td>Histogramme</td>
<td>x, fill, linetype, weight</td>
</tr>
<tr class="odd">
<td>geom_boxplot()</td>
<td>Boxplot</td>
<td>x, fill, weight</td>
</tr>
<tr class="even">
<td>geom_density()</td>
<td>Densité</td>
<td>x, y, fill, linetype</td>
</tr>
<tr class="odd">
<td>geom_contour()</td>
<td>Lignes de contour</td>
<td>x, y, fill, linetype</td>
</tr>
<tr class="even">
<td>geom_smooth()</td>
<td>Lisseur (linéaire ou non linéaire)</td>
<td>x, y, fill, linetype</td>
</tr>
<tr class="odd">
<td>Tous</td>
<td></td>
<td>color, size, group</td>
</tr>
</tbody>
</table>
<div class="exercise">
<p><span id="exr:exoggplot2" class="exercise"><strong>Exercice 4.6  (Diagrammes en barres) </strong></span>On étudie différentes façons de changer la couleur d’un diagramme en barres.</p>
<ol style="list-style-type: decimal">
<li><p>Tracer le diagramme en barres de la variable <strong>cut</strong> avec des barres bleues.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="ggplot2.html#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>cut)<span class="sc">+</span><span class="fu">geom_bar</span>(<span class="at">fill=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-293-1.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p>Tracer le diagramme en barres de la variable <strong>cut</strong> avec une couleur pour chaque modalité de <strong>cut</strong> ainsi qu’une légende qui permet de repérer la couleur.</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="ggplot2.html#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>cut,<span class="at">fill=</span>cut)<span class="sc">+</span><span class="fu">geom_bar</span>()</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-294-1.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p>Tracer le diagramme en barres de la variable <strong>cut</strong> avec une couleur pour chaque modalité que vous choisirez (et sans légende).</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="ggplot2.html#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>cut)<span class="sc">+</span><span class="fu">geom_bar</span>(<span class="at">fill=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>,<span class="st">&quot;green&quot;</span>,<span class="st">&quot;yellow&quot;</span>,<span class="st">&quot;black&quot;</span>))</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-295-1.png" width="672" style="display: block; margin: auto;" /></p></li>
</ol>
</div>
</div>
<div id="statistics" class="section level3" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> Statistics</h3>
<p>Certains graphes nécessitent des calculs d’indicateurs statistiques pour être tracé. C’est par exemple le cas pour le diagramme en barres et l’histogramme où il faut calculer des hauteurs de rectangles ou barres. Les transformations simples peuvent se faire rapidement, on peut par exemple tracer la fonction <strong>sinus</strong> avec</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="ggplot2.html#cb187-1" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>pi,<span class="dv">2</span><span class="sc">*</span>pi,<span class="at">by=</span><span class="fl">0.01</span>))</span>
<span id="cb187-2"><a href="ggplot2.html#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(D)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>X,<span class="at">y=</span><span class="fu">sin</span>(X))<span class="sc">+</span><span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-296-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>La transformation est spécifiée dans la fonction <code>aes</code>. Pour des transformations plus complexes, nous devons utiliser des <strong>statistics</strong>. Une fonction <strong>stat</strong> permet de définir des nouvelles variables à partir du jeu de données initial, il est ensuite possible de représenter ces nouvelles variables.
Par exemple, la fonction <strong>stat_bin</strong>, qui est utilisée par défaut pour construire des histogrammes, produit les variables suivantes :</p>
<ul>
<li><code>count</code>, le nombre d’observations dans chaque classes.</li>
<li><code>density</code>, la valeur de la densité des observations dans chaque classe (fréquance divisée par largeur de la classe).</li>
<li><code>x</code>, le centre de la classe.</li>
</ul>
<p>Par défaut <strong>geom_histogram</strong> fait appel à cette fonction <code>stat_bin</code>et représente sur l’axe <span class="math inline">\(y\)</span> le nombre d’observations dans chaque classe (la variable <strong>count</strong>).</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="ggplot2.html#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>price)<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">40</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-297-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Si on souhaite une autre variable issue de <code>stat_bin</code>, comme par exemple la densité, il faudra utiliser</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="ggplot2.html#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>price,<span class="at">y=</span>..density..)<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">40</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-298-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Il est possible d’utiliser les fonctions <strong>stat_</strong> à la place des <strong>geom_</strong> pour certaines représentations. Chaque fonction <strong>stat_</strong> possède par défaut un <strong>geom_</strong> et réciproquement. On peut par exemple obtenir le même graphe que précédemment avec</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="ggplot2.html#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>price,<span class="at">y=</span>..density..)<span class="sc">+</span><span class="fu">stat_bin</span>()</span></code></pre></div>
<p>Voici quelques exemple de fonctions <strong>stat_</strong></p>
<table>
<caption><span id="tab:ggplot-stat">Table 4.2: </span> Exemples de statistics.</caption>
<thead>
<tr class="header">
<th>Stat</th>
<th>Description</th>
<th>Paramètres</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>stat_identity()</td>
<td>aucune transformation</td>
<td></td>
</tr>
<tr class="even">
<td>stat_bin()</td>
<td>Count</td>
<td>binwidth, origin</td>
</tr>
<tr class="odd">
<td>stat_density()</td>
<td>Density</td>
<td>adjust, kernel</td>
</tr>
<tr class="even">
<td>stat_smooth()</td>
<td>Smoother</td>
<td>method, se</td>
</tr>
<tr class="odd">
<td>stat_boxplot()</td>
<td>Boxplot</td>
<td>coef</td>
</tr>
</tbody>
</table>
<p><em>stat</em> et <em>geom</em> ne sont pas toujours simples à combiner. Nous recommandons d’utiliser <strong>geom</strong> lorsqu’on débute avec <strong>ggplot</strong>, les <code>statistics</code>par défaut ne doivent en effet être changés que rarement.</p>
<p>:::{.exercise exo-stat1, name=“Diagramme en barres "très simple"…”}</p>
<p>On considère une variable qualitative <span class="math inline">\(X\)</span> dont la loi est donnée par
<span class="math display">\[P(X=\text{red})=0.3,\ P(X=\text{blue})=0.2,\ P(X=\text{green})=0.4,\ P(X=\text{black})=0.1\]</span>
Représenter cette distribution de probabilité avec un diagramme en barres.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="ggplot2.html#cb191-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X1=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;green&quot;</span>,<span class="st">&quot;black&quot;</span>),<span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.3</span>,<span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="fl">0.1</span>))</span>
<span id="cb191-2"><a href="ggplot2.html#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(X)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>X1,<span class="at">y=</span>prob,<span class="at">fill=</span>X1)<span class="sc">+</span><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>)<span class="sc">+</span></span>
<span id="cb191-3"><a href="ggplot2.html#cb191-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill=</span><span class="st">&quot;Couleur&quot;</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-300-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>:::</p>
<div class="exercise">
<p><span id="exr:exo-stat2" class="exercise"><strong>Exercice 4.7  (Lissage) </strong></span>On étudie différentes façons de visualiser un lissage.</p>
<ol style="list-style-type: decimal">
<li><p>Représenter le lissage non linéaire de la variable <code>price</code> contre la variable <code>carat</code> à l’aide de <code>geom_smooth</code> puis de <code>stat_smooth</code>.</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="ggplot2.html#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price)<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;loess&quot;</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-301-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="ggplot2.html#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price)<span class="sc">+</span><span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">&quot;loess&quot;</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-301-2.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p>Même question mais avec une ligne en pointillés à la place d’un trait plein.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="ggplot2.html#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price)<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;loess&quot;</span>,<span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-302-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="ggplot2.html#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price)<span class="sc">+</span><span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">&quot;loess&quot;</span>,<span class="at">geom=</span><span class="st">&quot;point&quot;</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-302-2.png" width="672" style="display: block; margin: auto;" /></p></li>
</ol>
</div>
</div>
<div id="scales" class="section level3" number="4.2.5">
<h3><span class="header-section-number">4.2.5</span> Scales</h3>
<p>Les échelles (<strong>scales</strong>) controlent tout un tas d’options telles que des changements de couleurs, d’échelles ou de limites d’axes, de symboles, etc… L’utilisation n’est pas simple et nécessite de la pratique. On utilise généralement ce verbe à la dernière étape de construction du graphe. La syntaxe est définie comme suit :</p>
<ul>
<li>début : <code>scale_</code>.</li>
<li>ajout de l’aesthetics que l’on souhaite modifier (<code>color_</code>, <code>fill_</code>, <code>x_</code>).</li>
<li>fin : nom de l’échelle (<code>manual</code>, <code>identity</code>…)</li>
</ul>
<p>Par exemple,</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="ggplot2.html#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price,<span class="at">color=</span>cut)<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb196-2"><a href="ggplot2.html#cb196-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;Fair&quot;</span><span class="ot">=</span><span class="st">&quot;black&quot;</span>,<span class="st">&quot;Good&quot;</span><span class="ot">=</span><span class="st">&quot;yellow&quot;</span>,</span>
<span id="cb196-3"><a href="ggplot2.html#cb196-3" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;Very Good&quot;</span><span class="ot">=</span><span class="st">&quot;blue&quot;</span>,<span class="st">&quot;Premium&quot;</span><span class="ot">=</span><span class="st">&quot;red&quot;</span>,<span class="st">&quot;Ideal&quot;</span><span class="ot">=</span><span class="st">&quot;green&quot;</span>))</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-303-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Voici quelques exemples des principales échelles :</p>
<table>
<caption><span id="tab:scales">Table 4.3: </span> Exemples d’échelles</caption>
<thead>
<tr class="header">
<th>aes</th>
<th>Discret</th>
<th>Continu</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Couleur (color et fill)</td>
<td>brewer</td>
<td>gradient</td>
</tr>
<tr class="even">
<td>-</td>
<td>grey</td>
<td>gradient2</td>
</tr>
<tr class="odd">
<td>-</td>
<td>hue</td>
<td>gradientn</td>
</tr>
<tr class="even">
<td>-</td>
<td>identity</td>
<td></td>
</tr>
<tr class="odd">
<td>-</td>
<td>manual</td>
<td></td>
</tr>
<tr class="even">
<td>Position (x et y)</td>
<td>discrete</td>
<td>continous</td>
</tr>
<tr class="odd">
<td>-</td>
<td></td>
<td>date</td>
</tr>
<tr class="even">
<td>Forme</td>
<td>shape</td>
<td></td>
</tr>
<tr class="odd">
<td>-</td>
<td>identity</td>
<td></td>
</tr>
<tr class="even">
<td>-</td>
<td>manual</td>
<td></td>
</tr>
<tr class="odd">
<td>Taille</td>
<td>identity</td>
<td>size</td>
</tr>
<tr class="even">
<td>-</td>
<td>manual</td>
<td></td>
</tr>
</tbody>
</table>
<p>Nous présentons quelques exemples d’utilisation des échelles :</p>
<ul>
<li><p><strong>Couleur dans un diagramme en barres</strong></p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="ggplot2.html#cb197-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>cut)<span class="sc">+</span><span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill=</span>cut))</span>
<span id="cb197-2"><a href="ggplot2.html#cb197-2" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-304-1.png" width="672" style="display: block; margin: auto;" />
On change la couleur en utilisant la palette <strong>Purples</strong> :</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="ggplot2.html#cb198-1" aria-hidden="true" tabindex="-1"></a>p1<span class="sc">+</span><span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">&quot;Purples&quot;</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-305-1.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p><strong>Gradient de couleurs pour un nuage de points</strong> :</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="ggplot2.html#cb199-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price)<span class="sc">+</span><span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>depth))</span>
<span id="cb199-2"><a href="ggplot2.html#cb199-2" aria-hidden="true" tabindex="-1"></a>p2</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-306-1.png" width="672" style="display: block; margin: auto;" />
On change le gradient de couleur</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="ggplot2.html#cb200-1" aria-hidden="true" tabindex="-1"></a>p2<span class="sc">+</span><span class="fu">scale_color_gradient</span>(<span class="at">low=</span><span class="st">&quot;red&quot;</span>,<span class="at">high=</span><span class="st">&quot;yellow&quot;</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-307-1.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p><strong>Modifications sur les axes</strong></p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="ggplot2.html#cb201-1" aria-hidden="true" tabindex="-1"></a>p2<span class="sc">+</span><span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="fl">0.5</span>,<span class="dv">3</span>,<span class="at">by=</span><span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb201-2"><a href="ggplot2.html#cb201-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name=</span><span class="st">&quot;prix&quot;</span>)<span class="sc">+</span></span>
<span id="cb201-3"><a href="ggplot2.html#cb201-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="st">&quot;Profondeur&quot;</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-308-1.png" width="672" style="display: block; margin: auto;" /></p></li>
</ul>
</div>
<div id="group-et-facets" class="section level3" number="4.2.6">
<h3><span class="header-section-number">4.2.6</span> Group et facets</h3>
<p><strong>ggplot</strong> permet de faire des représentations pour des groupes d’individus. On procède généralement de deux façons différentes :</p>
<ul>
<li>visualisation de sous groupes sur le même graphe, on utilise l’option <code>group</code> dans le verbe <strong>aes</strong> ;</li>
<li>visualisation de sous groupes sur des graphes différents, on utilise le verbe <strong>facet_wrap</strong> ou <strong>facet_grid</strong>.</li>
</ul>
<p>Représentons ici (sur le même graphe) le lisseur <strong>price vs carat</strong> pour chaque modalité de <em>cut</em></p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="ggplot2.html#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price,<span class="at">group=</span>cut)<span class="sc">+</span></span>
<span id="cb202-2"><a href="ggplot2.html#cb202-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;loess&quot;</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-309-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Pour obtenir cette représentation sur plusieurs fenêtres, on utilise</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="ggplot2.html#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price)<span class="sc">+</span></span>
<span id="cb203-2"><a href="ggplot2.html#cb203-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;loess&quot;</span>)<span class="sc">+</span><span class="fu">facet_wrap</span>(<span class="sc">~</span>cut)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-310-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="ggplot2.html#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price)<span class="sc">+</span></span>
<span id="cb204-2"><a href="ggplot2.html#cb204-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;loess&quot;</span>)<span class="sc">+</span><span class="fu">facet_wrap</span>(<span class="sc">~</span>cut,<span class="at">nrow=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-310-2.png" width="672" style="display: block; margin: auto;" /></p>
<p><strong>facet_grid</strong> et <strong>facet_wrap</strong> font des choses proches mais divisent la fenêtre d’une façon différente :</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="ggplot2.html#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price)<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb205-2"><a href="ggplot2.html#cb205-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>)<span class="sc">+</span><span class="fu">facet_grid</span>(color<span class="sc">~</span>cut)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-311-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="ggplot2.html#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price)<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb206-2"><a href="ggplot2.html#cb206-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>)<span class="sc">+</span><span class="fu">facet_wrap</span>(color<span class="sc">~</span>cut)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-311-2.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="compléments" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Compléments</h2>
<p>La syntaxe <strong>ggplot</strong> est définie selon le schéma :</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="ggplot2.html#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span><span class="fu">aes</span>()<span class="sc">+</span><span class="fu">geom_</span>()<span class="sc">+</span><span class="fu">scale_</span>()</span></code></pre></div>
<p>Elle est très flexible, on peut par exemple spécifier les variables de <code>aes</code> dans les verbes <code>ggplot</code> ou <code>geom_</code> :</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="ggplot2.html#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price)<span class="sc">+</span><span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-313-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="ggplot2.html#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2,<span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price))<span class="sc">+</span><span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-313-2.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="ggplot2.html#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price))</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-313-3.png" width="672" style="display: block; margin: auto;" /></p>
<p>Ceci peut se révéler très utile lorsqu’on utilise des <strong>aes</strong> différents dans les <strong>geom_</strong>.</p>
<p>On peut aussi construire un graphe à l’aide de différents jeux de données :</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="ggplot2.html#cb211-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>pi,<span class="dv">2</span><span class="sc">*</span>pi,<span class="at">by=</span><span class="fl">0.001</span>)</span>
<span id="cb211-2"><a href="ggplot2.html#cb211-2" aria-hidden="true" tabindex="-1"></a>Y1 <span class="ot">&lt;-</span> <span class="fu">cos</span>(X)</span>
<span id="cb211-3"><a href="ggplot2.html#cb211-3" aria-hidden="true" tabindex="-1"></a>Y2 <span class="ot">&lt;-</span> <span class="fu">sin</span>(X)</span>
<span id="cb211-4"><a href="ggplot2.html#cb211-4" aria-hidden="true" tabindex="-1"></a>donnees1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X,Y1)</span>
<span id="cb211-5"><a href="ggplot2.html#cb211-5" aria-hidden="true" tabindex="-1"></a>donnees2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X,Y2)</span>
<span id="cb211-6"><a href="ggplot2.html#cb211-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(donnees1)<span class="sc">+</span><span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>X,<span class="at">y=</span>Y1))<span class="sc">+</span></span>
<span id="cb211-7"><a href="ggplot2.html#cb211-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>donnees2,<span class="fu">aes</span>(<span class="at">x=</span>X,<span class="at">y=</span>Y2),<span class="at">color=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-314-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Il existe d’autres fonctions <strong>ggplot</strong> :</p>
<ul>
<li><strong>ggtitle</strong> pour ajouter un titre.</li>
<li><strong>ggsave</strong> pour sauver un graphe.</li>
<li><strong>theme_</strong> pour changer le theme du graphe.</li>
</ul>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="ggplot2.html#cb212-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price,<span class="at">color=</span>cut)<span class="sc">+</span><span class="fu">geom_point</span>()</span>
<span id="cb212-2"><a href="ggplot2.html#cb212-2" aria-hidden="true" tabindex="-1"></a>p<span class="sc">+</span><span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-315-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="ggplot2.html#cb213-1" aria-hidden="true" tabindex="-1"></a>p<span class="sc">+</span><span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-315-2.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="ggplot2.html#cb214-1" aria-hidden="true" tabindex="-1"></a>p<span class="sc">+</span><span class="fu">theme_grey</span>()</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-315-3.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="ggplot2.html#cb215-1" aria-hidden="true" tabindex="-1"></a>p<span class="sc">+</span><span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-315-4.png" width="672" style="display: block; margin: auto;" /></p>
<p>D’autres thèmes sont disponibles dans le package <strong>ggtheme</strong>. On pourra également parler de la fonction <code>set_theme</code> qui permet de modifier le thème par défaut pour un document <strong>Markdown</strong>.</p>
</div>
<div id="quelques-exercices-supplémentaires" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Quelques exercices supplémentaires</h2>
<div class="exercise">
<p><span id="exr:exo-cos-sin" class="exercise"><strong>Exercice 4.8  (Fonctions cosinus et sinus) </strong></span>L’objectif est de visualiser les fonctions <strong>sinus</strong> et <strong>cosinus</strong> de plusieurs façons.</p>
<ol style="list-style-type: decimal">
<li><p>Tracer les fonctions sinus et cosinus. On utilisera tout d’abord deux jeux de données : un pour le sinus, l’autre pour le cosinus.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="ggplot2.html#cb216-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>pi,<span class="dv">2</span><span class="sc">*</span>pi,<span class="at">by=</span><span class="fl">0.001</span>)</span>
<span id="cb216-2"><a href="ggplot2.html#cb216-2" aria-hidden="true" tabindex="-1"></a>Y1 <span class="ot">&lt;-</span> <span class="fu">cos</span>(X)</span>
<span id="cb216-3"><a href="ggplot2.html#cb216-3" aria-hidden="true" tabindex="-1"></a>Y2 <span class="ot">&lt;-</span> <span class="fu">sin</span>(X)</span>
<span id="cb216-4"><a href="ggplot2.html#cb216-4" aria-hidden="true" tabindex="-1"></a>donnees1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X,Y1)</span>
<span id="cb216-5"><a href="ggplot2.html#cb216-5" aria-hidden="true" tabindex="-1"></a>donnees2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X,Y2)</span>
<span id="cb216-6"><a href="ggplot2.html#cb216-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(donnees1)<span class="sc">+</span><span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>X,<span class="at">y=</span>Y1))<span class="sc">+</span></span>
<span id="cb216-7"><a href="ggplot2.html#cb216-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>donnees2,<span class="fu">aes</span>(<span class="at">x=</span>X,<span class="at">y=</span>Y2),<span class="at">color=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-316-1.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p>Faire la même chose avec un jeu de données et deux appels à la fonction <code>geom_line</code>. On pourra ajouter une légende.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="ggplot2.html#cb217-1" aria-hidden="true" tabindex="-1"></a>donnees <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X,Y1,Y2)</span>
<span id="cb217-2"><a href="ggplot2.html#cb217-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(donnees)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>X,<span class="at">y=</span>Y1)<span class="sc">+</span><span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb217-3"><a href="ggplot2.html#cb217-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>Y2),<span class="at">color=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-317-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="ggplot2.html#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ou pour la légende</span></span>
<span id="cb218-2"><a href="ggplot2.html#cb218-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(donnees)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>X,<span class="at">y=</span>Y1)<span class="sc">+</span><span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span><span class="st">&quot;cos&quot;</span>))<span class="sc">+</span></span>
<span id="cb218-3"><a href="ggplot2.html#cb218-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>Y2,<span class="at">color=</span><span class="st">&quot;sin&quot;</span>))<span class="sc">+</span><span class="fu">labs</span>(<span class="at">color=</span><span class="st">&quot;Fonction&quot;</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-317-2.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p>Faire la même chose avec un jeu de données et un seul appel à <code>geom_line</code>. On pourra utiliser la fonction <strong>pivot_longer</strong> du <strong>tidyverse</strong>.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="ggplot2.html#cb219-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X,<span class="at">cos=</span>Y1,<span class="at">sin=</span>Y2)</span>
<span id="cb219-2"><a href="ggplot2.html#cb219-2" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">c</span>(cos,sin),</span>
<span id="cb219-3"><a href="ggplot2.html#cb219-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">names_to =</span> <span class="st">&quot;Fonction&quot;</span>,</span>
<span id="cb219-4"><a href="ggplot2.html#cb219-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>)</span>
<span id="cb219-5"><a href="ggplot2.html#cb219-5" aria-hidden="true" tabindex="-1"></a><span class="co">#ou</span></span>
<span id="cb219-6"><a href="ggplot2.html#cb219-6" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="sc">-</span>X,</span>
<span id="cb219-7"><a href="ggplot2.html#cb219-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">names_to =</span> <span class="st">&quot;Fonction&quot;</span>,</span>
<span id="cb219-8"><a href="ggplot2.html#cb219-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>)</span>
<span id="cb219-9"><a href="ggplot2.html#cb219-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df1)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>X,<span class="at">y=</span>value,<span class="at">color=</span>Fonction)<span class="sc">+</span><span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-318-1.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p>Tracer les deux fonctions sur deux fenêtres graphiques (utiliser <code>facet_wrap</code>).</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="ggplot2.html#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df1)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>X,<span class="at">y=</span>value)<span class="sc">+</span><span class="fu">geom_line</span>()<span class="sc">+</span><span class="fu">facet_wrap</span>(<span class="sc">~</span>Fonction)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-319-1.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p>Faire la même chose avec la fonction <code>grid.arrange</code> du package <strong>gridExtra</strong>.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="ggplot2.html#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb221-2"><a href="ggplot2.html#cb221-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(donnees1)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>X,<span class="at">y=</span>Y1)<span class="sc">+</span><span class="fu">geom_line</span>()</span>
<span id="cb221-3"><a href="ggplot2.html#cb221-3" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(donnees2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>X,<span class="at">y=</span>Y2)<span class="sc">+</span><span class="fu">geom_line</span>()</span>
<span id="cb221-4"><a href="ggplot2.html#cb221-4" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1,p2,<span class="at">nrow=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-320-1.png" width="672" style="display: block; margin: auto;" /></p></li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:exo-mtcars" class="exercise"><strong>Exercice 4.9  (Différents graphes) </strong></span>On considère les données <code>mtcars</code></p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="ggplot2.html#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb222-2"><a href="ggplot2.html#cb222-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mtcars)</span>
<span id="cb222-3"><a href="ggplot2.html#cb222-3" aria-hidden="true" tabindex="-1"></a>      mpg             cyl             disp      </span>
<span id="cb222-4"><a href="ggplot2.html#cb222-4" aria-hidden="true" tabindex="-1"></a> Min.   <span class="sc">:</span><span class="fl">10.40</span>   Min.   <span class="sc">:</span><span class="fl">4.000</span>   Min.   <span class="sc">:</span> <span class="fl">71.1</span>  </span>
<span id="cb222-5"><a href="ggplot2.html#cb222-5" aria-hidden="true" tabindex="-1"></a> 1st Qu.<span class="sc">:</span><span class="fl">15.43</span>   1st Qu.<span class="sc">:</span><span class="fl">4.000</span>   1st Qu.<span class="sc">:</span><span class="fl">120.8</span>  </span>
<span id="cb222-6"><a href="ggplot2.html#cb222-6" aria-hidden="true" tabindex="-1"></a> Median <span class="sc">:</span><span class="fl">19.20</span>   Median <span class="sc">:</span><span class="fl">6.000</span>   Median <span class="sc">:</span><span class="fl">196.3</span>  </span>
<span id="cb222-7"><a href="ggplot2.html#cb222-7" aria-hidden="true" tabindex="-1"></a> Mean   <span class="sc">:</span><span class="fl">20.09</span>   Mean   <span class="sc">:</span><span class="fl">6.188</span>   Mean   <span class="sc">:</span><span class="fl">230.7</span>  </span>
<span id="cb222-8"><a href="ggplot2.html#cb222-8" aria-hidden="true" tabindex="-1"></a> 3rd Qu.<span class="sc">:</span><span class="fl">22.80</span>   3rd Qu.<span class="sc">:</span><span class="fl">8.000</span>   3rd Qu.<span class="sc">:</span><span class="fl">326.0</span>  </span>
<span id="cb222-9"><a href="ggplot2.html#cb222-9" aria-hidden="true" tabindex="-1"></a> Max.   <span class="sc">:</span><span class="fl">33.90</span>   Max.   <span class="sc">:</span><span class="fl">8.000</span>   Max.   <span class="sc">:</span><span class="fl">472.0</span>  </span>
<span id="cb222-10"><a href="ggplot2.html#cb222-10" aria-hidden="true" tabindex="-1"></a>       hp             drat             wt       </span>
<span id="cb222-11"><a href="ggplot2.html#cb222-11" aria-hidden="true" tabindex="-1"></a> Min.   <span class="sc">:</span> <span class="fl">52.0</span>   Min.   <span class="sc">:</span><span class="fl">2.760</span>   Min.   <span class="sc">:</span><span class="fl">1.513</span>  </span>
<span id="cb222-12"><a href="ggplot2.html#cb222-12" aria-hidden="true" tabindex="-1"></a> 1st Qu.<span class="sc">:</span> <span class="fl">96.5</span>   1st Qu.<span class="sc">:</span><span class="fl">3.080</span>   1st Qu.<span class="sc">:</span><span class="fl">2.581</span>  </span>
<span id="cb222-13"><a href="ggplot2.html#cb222-13" aria-hidden="true" tabindex="-1"></a> Median <span class="sc">:</span><span class="fl">123.0</span>   Median <span class="sc">:</span><span class="fl">3.695</span>   Median <span class="sc">:</span><span class="fl">3.325</span>  </span>
<span id="cb222-14"><a href="ggplot2.html#cb222-14" aria-hidden="true" tabindex="-1"></a> Mean   <span class="sc">:</span><span class="fl">146.7</span>   Mean   <span class="sc">:</span><span class="fl">3.597</span>   Mean   <span class="sc">:</span><span class="fl">3.217</span>  </span>
<span id="cb222-15"><a href="ggplot2.html#cb222-15" aria-hidden="true" tabindex="-1"></a> 3rd Qu.<span class="sc">:</span><span class="fl">180.0</span>   3rd Qu.<span class="sc">:</span><span class="fl">3.920</span>   3rd Qu.<span class="sc">:</span><span class="fl">3.610</span>  </span>
<span id="cb222-16"><a href="ggplot2.html#cb222-16" aria-hidden="true" tabindex="-1"></a> Max.   <span class="sc">:</span><span class="fl">335.0</span>   Max.   <span class="sc">:</span><span class="fl">4.930</span>   Max.   <span class="sc">:</span><span class="fl">5.424</span>  </span>
<span id="cb222-17"><a href="ggplot2.html#cb222-17" aria-hidden="true" tabindex="-1"></a>      qsec             vs               am        </span>
<span id="cb222-18"><a href="ggplot2.html#cb222-18" aria-hidden="true" tabindex="-1"></a> Min.   <span class="sc">:</span><span class="fl">14.50</span>   Min.   <span class="sc">:</span><span class="fl">0.0000</span>   Min.   <span class="sc">:</span><span class="fl">0.0000</span>  </span>
<span id="cb222-19"><a href="ggplot2.html#cb222-19" aria-hidden="true" tabindex="-1"></a> 1st Qu.<span class="sc">:</span><span class="fl">16.89</span>   1st Qu.<span class="sc">:</span><span class="fl">0.0000</span>   1st Qu.<span class="sc">:</span><span class="fl">0.0000</span>  </span>
<span id="cb222-20"><a href="ggplot2.html#cb222-20" aria-hidden="true" tabindex="-1"></a> Median <span class="sc">:</span><span class="fl">17.71</span>   Median <span class="sc">:</span><span class="fl">0.0000</span>   Median <span class="sc">:</span><span class="fl">0.0000</span>  </span>
<span id="cb222-21"><a href="ggplot2.html#cb222-21" aria-hidden="true" tabindex="-1"></a> Mean   <span class="sc">:</span><span class="fl">17.85</span>   Mean   <span class="sc">:</span><span class="fl">0.4375</span>   Mean   <span class="sc">:</span><span class="fl">0.4062</span>  </span>
<span id="cb222-22"><a href="ggplot2.html#cb222-22" aria-hidden="true" tabindex="-1"></a> 3rd Qu.<span class="sc">:</span><span class="fl">18.90</span>   3rd Qu.<span class="sc">:</span><span class="fl">1.0000</span>   3rd Qu.<span class="sc">:</span><span class="fl">1.0000</span>  </span>
<span id="cb222-23"><a href="ggplot2.html#cb222-23" aria-hidden="true" tabindex="-1"></a> Max.   <span class="sc">:</span><span class="fl">22.90</span>   Max.   <span class="sc">:</span><span class="fl">1.0000</span>   Max.   <span class="sc">:</span><span class="fl">1.0000</span>  </span>
<span id="cb222-24"><a href="ggplot2.html#cb222-24" aria-hidden="true" tabindex="-1"></a>      gear            carb      </span>
<span id="cb222-25"><a href="ggplot2.html#cb222-25" aria-hidden="true" tabindex="-1"></a> Min.   <span class="sc">:</span><span class="fl">3.000</span>   Min.   <span class="sc">:</span><span class="fl">1.000</span>  </span>
<span id="cb222-26"><a href="ggplot2.html#cb222-26" aria-hidden="true" tabindex="-1"></a> 1st Qu.<span class="sc">:</span><span class="fl">3.000</span>   1st Qu.<span class="sc">:</span><span class="fl">2.000</span>  </span>
<span id="cb222-27"><a href="ggplot2.html#cb222-27" aria-hidden="true" tabindex="-1"></a> Median <span class="sc">:</span><span class="fl">4.000</span>   Median <span class="sc">:</span><span class="fl">2.000</span>  </span>
<span id="cb222-28"><a href="ggplot2.html#cb222-28" aria-hidden="true" tabindex="-1"></a> Mean   <span class="sc">:</span><span class="fl">3.688</span>   Mean   <span class="sc">:</span><span class="fl">2.812</span>  </span>
<span id="cb222-29"><a href="ggplot2.html#cb222-29" aria-hidden="true" tabindex="-1"></a> 3rd Qu.<span class="sc">:</span><span class="fl">4.000</span>   3rd Qu.<span class="sc">:</span><span class="fl">4.000</span>  </span>
<span id="cb222-30"><a href="ggplot2.html#cb222-30" aria-hidden="true" tabindex="-1"></a> Max.   <span class="sc">:</span><span class="fl">5.000</span>   Max.   <span class="sc">:</span><span class="fl">8.000</span>  </span></code></pre></div>
<ol style="list-style-type: decimal">
<li><p>Tracer l’histogramme de <code>mpg</code> (on fera varier le nombre de classes).</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="ggplot2.html#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>mpg)<span class="sc">+</span><span class="fu">geom_histogram</span>()</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-322-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="ggplot2.html#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>mpg)<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">10</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-322-2.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p>Tracer l’histogramme de la densité.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="ggplot2.html#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>mpg,<span class="at">y=</span>..density..)<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">10</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-323-1.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p>Tracer le diagramme en barres de <code>cyl</code>.</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="ggplot2.html#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>cyl)<span class="sc">+</span><span class="fu">geom_bar</span>()</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-324-1.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p>Tracer le nuage de points <code>disp vs mpg</code> en utilisant une couleur différente pour chaque valeur de <code>cyl</code>.</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="ggplot2.html#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>disp,<span class="at">y=</span>mpg,<span class="at">color=</span>cyl)<span class="sc">+</span><span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-325-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="ggplot2.html#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>disp,<span class="at">y=</span>mpg,<span class="at">color=</span><span class="fu">as.factor</span>(cyl))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">labs</span>(<span class="at">color=</span><span class="st">&quot;cyl&quot;</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-325-2.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p>Ajouter le lisseur linéaire sur le graphe (un lisseur par modalité de <code>cyl</code>).</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="ggplot2.html#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>disp,<span class="at">y=</span>mpg,<span class="at">color=</span><span class="fu">as.factor</span>(cyl))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb229-2"><a href="ggplot2.html#cb229-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">color=</span><span class="st">&quot;cyl&quot;</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-326-1.png" width="672" style="display: block; margin: auto;" /></p></li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:ggplot-reg-simple" class="exercise"><strong>Exercice 4.10  (Résidus pour régression simple) </strong></span>On souhaite visualiser les résidus dans un modèle de régression simple.</p>
<ol style="list-style-type: decimal">
<li><p>Générer un échantillon <span class="math inline">\((x_i,y_i),i=1,\dots,100\)</span> selon le modèle linéaire
<span class="math display">\[y_i=3+x_i+\varepsilon_i\]</span>
où les <span class="math inline">\(x_i\)</span> sont i.i.d. de loi uniforme sur <span class="math inline">\([0,1]\)</span> et les <span class="math inline">\(\varepsilon_i\)</span> sont i.i.d. de loi gaussienne <span class="math inline">\(N(0,0.2^2)\)</span> (utiliser <strong>runif</strong> et <strong>rnorm</strong>).</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="ggplot2.html#cb230-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb230-2"><a href="ggplot2.html#cb230-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb230-3"><a href="ggplot2.html#cb230-3" aria-hidden="true" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="at">sd=</span><span class="fl">0.2</span>)</span>
<span id="cb230-4"><a href="ggplot2.html#cb230-4" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">+</span>X<span class="sc">+</span>eps</span>
<span id="cb230-5"><a href="ggplot2.html#cb230-5" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X,Y)</span></code></pre></div></li>
<li><p>Tracer le nuage de points <strong>Y vs X</strong> et ajouter le lisseur linéaire.</p>
<div class="corR">
<p>
On le fait d’abord “à la main” en calculant l’équation de la droite de régression.
</p>
</div>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="ggplot2.html#cb231-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y<span class="sc">~</span>.,<span class="at">data=</span>D)</span>
<span id="cb231-2"><a href="ggplot2.html#cb231-2" aria-hidden="true" tabindex="-1"></a>co <span class="ot">&lt;-</span> <span class="fu">coef</span>(model)</span>
<span id="cb231-3"><a href="ggplot2.html#cb231-3" aria-hidden="true" tabindex="-1"></a>D<span class="sc">$</span>fit <span class="ot">&lt;-</span> <span class="fu">predict</span>(model)</span>
<span id="cb231-4"><a href="ggplot2.html#cb231-4" aria-hidden="true" tabindex="-1"></a>co <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">lm</span>(Y<span class="sc">~</span>.,<span class="at">data=</span>D))</span>
<span id="cb231-5"><a href="ggplot2.html#cb231-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(D)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>X,<span class="at">y=</span>Y)<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb231-6"><a href="ggplot2.html#cb231-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span>co[<span class="dv">2</span>],<span class="at">intercept=</span>co[<span class="dv">1</span>],<span class="at">color=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-329-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="corR">
<p>
On peut avoir le tracé directement avec <code>geom_smooth</code>.
</p>
</div>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="ggplot2.html#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(D)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>X,<span class="at">y=</span>Y)<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>)</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-331-1.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p>Représenter les résidus : on ajoutera une ligne verticale entre chaque point et la droite de lissage (utiliser <strong>geom_segment</strong>).</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="ggplot2.html#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(D)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>X,<span class="at">y=</span>Y)<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>)<span class="sc">+</span></span>
<span id="cb233-2"><a href="ggplot2.html#cb233-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend=</span>X,<span class="at">yend=</span>fit))</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-332-1.png" width="672" style="display: block; margin: auto;" /></p></li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:ggplot-challenge" class="exercise"><strong>Exercice 4.11  (Challenge) </strong></span>On considère les données <strong>diamonds</strong>.</p>
<ol style="list-style-type: decimal">
<li><p>Tracer les graphes suivants (utiliser <code>coord_flip</code> pour le second).</p>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-333-1.png" width="672" style="display: block; margin: auto;" /><img src="TUTO_R_files/figure-html/unnamed-chunk-333-2.png" width="672" style="display: block; margin: auto;" /><img src="TUTO_R_files/figure-html/unnamed-chunk-333-3.png" width="672" style="display: block; margin: auto;" /></p>
<div class="corR">
<p>
On obtient les graphes demandés avec :
</p>
</div>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="ggplot2.html#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>diamonds) <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>cut,<span class="at">y=</span>carat,<span class="at">fill=</span>cut)) </span>
<span id="cb234-2"><a href="ggplot2.html#cb234-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>diamonds) <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>cut,<span class="at">y=</span>carat,<span class="at">fill=</span>cut)) <span class="sc">+</span> <span class="fu">coord_flip</span>()</span>
<span id="cb234-3"><a href="ggplot2.html#cb234-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>diamonds) <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>..density..)) <span class="sc">+</span> <span class="fu">facet_grid</span>(cut<span class="sc">~</span>.)</span></code></pre></div></li>
<li><p>Ajouter sur le troisième graphe les quartiles de la variable <strong>carat</strong> pour chaque valeur de <strong>cut</strong>. On utilisera une ligne verticale.</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="ggplot2.html#cb235-1" aria-hidden="true" tabindex="-1"></a>Q1 <span class="ot">&lt;-</span> diamonds <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(cut) <span class="sc">%&gt;%</span> </span>
<span id="cb235-2"><a href="ggplot2.html#cb235-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">q1=</span><span class="fu">quantile</span>(carat,<span class="fu">c</span>(<span class="fl">0.25</span>)),<span class="at">q2=</span><span class="fu">quantile</span>(carat,<span class="fu">c</span>(<span class="fl">0.5</span>)),</span>
<span id="cb235-3"><a href="ggplot2.html#cb235-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">q3=</span><span class="fu">quantile</span>(carat,<span class="fu">c</span>(<span class="fl">0.75</span>)))</span>
<span id="cb235-4"><a href="ggplot2.html#cb235-4" aria-hidden="true" tabindex="-1"></a>quantildf <span class="ot">&lt;-</span> Q1 <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="sc">-</span>cut,<span class="at">names_to=</span><span class="st">&quot;alpha&quot;</span>,<span class="at">values_to=</span><span class="st">&quot;quantiles&quot;</span>)</span>
<span id="cb235-5"><a href="ggplot2.html#cb235-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>diamonds) <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>..density..)) <span class="sc">+</span></span>
<span id="cb235-6"><a href="ggplot2.html#cb235-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(cut<span class="sc">~</span>.) <span class="sc">+</span></span>
<span id="cb235-7"><a href="ggplot2.html#cb235-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data=</span>quantildf,<span class="fu">aes</span>(<span class="at">xintercept=</span>quantiles),<span class="at">col=</span><span class="fu">alpha</span>(<span class="st">&quot;black&quot;</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>))</span></code></pre></div>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-336-1.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p>En déduire le graphe suivant (on utilisera le package <strong>ggstance</strong>).</p>
<p><img src="TUTO_R_files/figure-html/unnamed-chunk-337-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="corR">
<p>
On l’obtient avec
</p>
</div>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="ggplot2.html#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggstance)</span>
<span id="cb236-2"><a href="ggplot2.html#cb236-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>diamonds) <span class="sc">+</span></span>
<span id="cb236-3"><a href="ggplot2.html#cb236-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxploth</span>(<span class="at">data=</span>diamonds,<span class="fu">aes</span>(<span class="at">y=</span><span class="sc">-</span><span class="fl">0.5</span>,<span class="at">x=</span>carat,<span class="at">fill=</span>cut)) <span class="sc">+</span></span>
<span id="cb236-4"><a href="ggplot2.html#cb236-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>..density..)) <span class="sc">+</span>  <span class="fu">facet_grid</span>(cut<span class="sc">~</span>.) <span class="sc">+</span></span>
<span id="cb236-5"><a href="ggplot2.html#cb236-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data=</span>quantildf,<span class="fu">aes</span>(<span class="at">xintercept=</span>quantiles),<span class="at">col=</span><span class="fu">alpha</span>(<span class="st">&quot;black&quot;</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb236-6"><a href="ggplot2.html#cb236-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;&quot;</span>)</span></code></pre></div></li>
</ol>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="dplyr.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="leaflet.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "sepia",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["TUTO_R.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"sharing": {
"facebook": true,
"github": true,
"twitter": true
}
},
"highlight": "tango"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
